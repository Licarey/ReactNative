Propsï¼ˆå±æ€§ï¼‰

å¤§å¤šæ•°ç»„ä»¶åœ¨åˆ›å»ºæ—¶å°±å¯ä»¥ä½¿ç”¨å„ç§å‚æ•°æ¥è¿›è¡Œå®šåˆ¶ã€‚ç”¨äºå®šåˆ¶çš„è¿™äº›å‚æ•°å°±ç§°ä¸ºpropsï¼ˆå±æ€§ï¼‰ã€‚

ä»¥å¸¸è§çš„åŸºç¡€ç»„ä»¶Imageä¸ºä¾‹ï¼Œåœ¨åˆ›å»ºä¸€ä¸ªå›¾ç‰‡æ—¶ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªåä¸ºsourceçš„propæ¥æŒ‡å®šè¦æ˜¾ç¤ºçš„å›¾ç‰‡çš„åœ°å€ï¼Œä»¥åŠä½¿ç”¨åä¸ºstyleçš„propæ¥æ§åˆ¶å…¶å°ºå¯¸ã€‚

import React, { Component } from 'react';
import { Image } from 'react-native';

export default class Bananas extends Component {
  render() {
    let pic = {
      uri: 'https://upload.wikimedia.org/wikipedia/commons/d/de/Bananavarieties.jpg'
    };
    return (
      <Image source={pic} style={{width: 193, height: 110}} />
    );
  }
}

{pic}å¤–å›´æœ‰ä¸€å±‚æ‹¬å·ï¼Œæˆ‘ä»¬éœ€è¦ç”¨æ‹¬å·æ¥æŠŠpicè¿™ä¸ªå˜é‡åµŒå…¥åˆ°JSXè¯­å¥ä¸­ã€‚æ‹¬å·çš„æ„æ€æ˜¯æ‹¬å·å†…éƒ¨ä¸ºä¸€ä¸ªjså˜é‡æˆ–è¡¨è¾¾å¼ï¼Œéœ€è¦æ‰§è¡Œåå–å€¼ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠä»»æ„åˆæ³•çš„JavaScriptè¡¨è¾¾å¼é€šè¿‡æ‹¬å·åµŒå…¥åˆ°JSXè¯­å¥ä¸­ã€‚
è‡ªå®šä¹‰çš„ç»„ä»¶ä¹Ÿå¯ä»¥ä½¿ç”¨propsã€‚é€šè¿‡åœ¨ä¸åŒçš„åœºæ™¯ä½¿ç”¨ä¸åŒçš„å±æ€§å®šåˆ¶ï¼Œå¯ä»¥å°½é‡æé«˜è‡ªå®šä¹‰ç»„ä»¶çš„å¤ç”¨èŒƒç•´ã€‚åªéœ€åœ¨renderå‡½æ•°ä¸­å¼•ç”¨this.propsï¼Œç„¶åæŒ‰éœ€å¤„ç†å³å¯

import React, { Component } from 'react';
import { Text, View } from 'react-native';

class Greeting extends Component {
  render() {
    return (
      <Text>Hello {this.props.name}!</Text>
    );
  }
}

export default class LotsOfGreetings extends Component {
  render() {
    return (
      <View style={{alignItems: 'center'}}>
        <Greeting name='Rexxar' />
        <Greeting name='Jaina' />
        <Greeting name='Valeera' />
      </View>
    );
  }
}

æˆ‘ä»¬åœ¨Greetingç»„ä»¶ä¸­å°†nameä½œä¸ºä¸€ä¸ªå±æ€§æ¥å®šåˆ¶

Stateï¼ˆçŠ¶æ€ï¼‰
åˆ¶ä½œä¸€æ®µä¸åœé—ªçƒçš„æ–‡å­—ã€‚æ–‡å­—å†…å®¹æœ¬èº«åœ¨ç»„ä»¶åˆ›å»ºæ—¶å°±å·²ç»æŒ‡å®šå¥½äº†ï¼Œæ‰€ä»¥æ–‡å­—å†…å®¹åº”è¯¥æ˜¯ä¸€ä¸ªpropã€‚è€Œæ–‡å­—çš„æ˜¾ç¤ºæˆ–éšè—çš„çŠ¶æ€ï¼ˆå¿«é€Ÿçš„æ˜¾éšåˆ‡æ¢å°±äº§ç”Ÿäº†é—ªçƒçš„æ•ˆæœï¼‰åˆ™æ˜¯éšç€æ—¶é—´å˜åŒ–çš„ï¼Œå› æ­¤è¿™ä¸€çŠ¶æ€åº”è¯¥å†™åˆ°stateä¸­ã€‚

import React, { Component } from 'react';
import { Text, View } from 'react-native';

class Blink extends Component {
  constructor(props) {
    super(props);
    this.state = { showText: true };

    // æ¯1000æ¯«ç§’å¯¹showTextçŠ¶æ€åšä¸€æ¬¡å–åæ“ä½œ
    setInterval(() => {
      this.setState(previousState => {
        return { showText: !previousState.showText };
      });
    }, 1000);
  }

  render() {
    // æ ¹æ®å½“å‰showTextçš„å€¼å†³å®šæ˜¯å¦æ˜¾ç¤ºtextå†…å®¹
    let display = this.state.showText ? this.props.text : ' ';
    return (
      <Text>{display}</Text>
    );
  }
}

export default class BlinkApp extends Component {
  render() {
    return (
      <View>
        <Blink text='I love to blink' />
        <Blink text='Yes blinking is so great' />
        <Blink text='Why did they ever take this out of HTML' />
        <Blink text='Look at me look at me look at me' />
      </View>
    );
  }
}

Stateçš„å·¥ä½œåŸç†å’ŒReact.jså®Œå…¨ä¸€è‡´

æ ·å¼
åœ¨React Nativeä¸­ï¼Œä½ å¹¶ä¸éœ€è¦å­¦ä¹ ä»€ä¹ˆç‰¹æ®Šçš„è¯­æ³•æ¥å®šä¹‰æ ·å¼ã€‚æˆ‘ä»¬ä»ç„¶æ˜¯ä½¿ç”¨JavaScriptæ¥å†™æ ·å¼ã€‚æ‰€æœ‰çš„æ ¸å¿ƒç»„ä»¶éƒ½æ¥å—åä¸ºstyleçš„å±æ€§ã€‚è¿™äº›æ ·å¼ååŸºæœ¬ä¸Šæ˜¯éµå¾ªäº†webä¸Šçš„CSSçš„å‘½åï¼Œåªæ˜¯æŒ‰ç…§JSçš„è¯­æ³•è¦æ±‚ä½¿ç”¨äº†é©¼å³°å‘½åæ³•ï¼Œä¾‹å¦‚å°†background-coloræ”¹ä¸ºbackgroundColorã€‚
styleå±æ€§å¯ä»¥æ˜¯ä¸€ä¸ªæ™®é€šçš„JavaScriptå¯¹è±¡ï¼Œå®é™…å¼€å‘ä¸­ç»„ä»¶çš„æ ·å¼ä¼šè¶Šæ¥è¶Šå¤æ‚ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨StyleSheet.createæ¥é›†ä¸­å®šä¹‰ç»„ä»¶çš„æ ·å¼
import React, { Component } from 'react';
import { AppRegistry, StyleSheet, Text, View } from 'react-native';

export default class LotsOfStyles extends Component {
  render() {
    return (
      <View>
        <Text style={styles.red}>just red</Text>
        <Text style={styles.bigblue}>just bigblue</Text>
        <Text style={[styles.bigblue, styles.red]}>bigblue, then red</Text>
        <Text style={[styles.red, styles.bigblue]}>red, then bigblue</Text>
      </View>
    );
  }
}

const styles = StyleSheet.create({
  bigblue: {
    color: 'blue',
    fontWeight: 'bold',
    fontSize: 30,
  },
  red: {
    color: 'red',
  },
});
AppRegistry.registerComponent('LotsOfStyles', () => LotsOfStyles);

å®½åº¦ä¸é«˜åº¦
æœ€ç®€å•çš„ç»™ç»„ä»¶è®¾å®šå°ºå¯¸çš„æ–¹å¼å°±æ˜¯åœ¨æ ·å¼ä¸­æŒ‡å®šå›ºå®šçš„widthå’Œheightã€‚React Nativeä¸­çš„å°ºå¯¸éƒ½æ˜¯æ— å•ä½çš„ï¼Œè¡¨ç¤ºçš„æ˜¯ä¸è®¾å¤‡åƒç´ å¯†åº¦æ— å…³çš„é€»è¾‘åƒç´ ç‚¹ã€‚
import React, { Component } from 'react';
import { AppRegistry, View } from 'react-native';

export default class FixedDimensionsBasics extends Component {
  render() {
    return (
      <View>
        <View style={{width: 50, height: 50, backgroundColor: 'powderblue'}} />
        <View style={{width: 100, height: 100, backgroundColor: 'skyblue'}} />
        <View style={{width: 150, height: 150, backgroundColor: 'steelblue'}} />
      </View>
    );
  }
};
// æ³¨å†Œåº”ç”¨(registerComponent)åæ‰èƒ½æ­£ç¡®æ¸²æŸ“
// æ³¨æ„ï¼šåªæŠŠåº”ç”¨ä½œä¸ºä¸€ä¸ªæ•´ä½“æ³¨å†Œä¸€æ¬¡ï¼Œè€Œä¸æ˜¯æ¯ä¸ªç»„ä»¶/æ¨¡å—éƒ½æ³¨å†Œ
AppRegistry.registerComponent('AwesomeProject', () => FixedDimensionsBasics);
è¿™æ ·ç»™ç»„ä»¶è®¾ç½®å°ºå¯¸ä¹Ÿæ˜¯ä¸€ç§å¸¸è§çš„æ¨¡å¼ï¼Œæ¯”å¦‚è¦æ±‚åœ¨ä¸åŒå°ºå¯¸çš„å±å¹•ä¸Šéƒ½æ˜¾ç¤ºæˆä¸€æ ·çš„å¤§å°ã€‚

å¼¹æ€§ï¼ˆFlexï¼‰å®½é«˜
åœ¨ç»„ä»¶æ ·å¼ä¸­ä½¿ç”¨flexå¯ä»¥ä½¿å…¶åœ¨å¯åˆ©ç”¨çš„ç©ºé—´ä¸­åŠ¨æ€åœ°æ‰©å¼ æˆ–æ”¶ç¼©ã€‚ä¸€èˆ¬è€Œè¨€æˆ‘ä»¬ä¼šä½¿ç”¨flex:1æ¥æŒ‡å®šæŸä¸ªç»„ä»¶æ‰©å¼ ä»¥æ’‘æ»¡æ‰€æœ‰å‰©ä½™çš„ç©ºé—´ã€‚å¦‚æœæœ‰å¤šä¸ªå¹¶åˆ—çš„å­ç»„ä»¶ä½¿ç”¨äº†flex:1ï¼Œåˆ™è¿™äº›å­ç»„ä»¶ä¼šå¹³åˆ†çˆ¶å®¹å™¨ä¸­å‰©ä½™çš„ç©ºé—´ã€‚å¦‚æœè¿™äº›å¹¶åˆ—çš„å­ç»„ä»¶çš„flexå€¼ä¸ä¸€æ ·ï¼Œåˆ™è°çš„å€¼æ›´å¤§ï¼Œè°å æ®å‰©ä½™ç©ºé—´çš„æ¯”ä¾‹å°±æ›´å¤§ï¼ˆå³å æ®å‰©ä½™ç©ºé—´çš„æ¯”ç­‰äºå¹¶åˆ—ç»„ä»¶é—´flexå€¼çš„æ¯”ï¼‰ã€‚
ç»„ä»¶èƒ½å¤Ÿæ’‘æ»¡å‰©ä½™ç©ºé—´çš„å‰ææ˜¯å…¶çˆ¶å®¹å™¨çš„å°ºå¯¸ä¸ä¸ºé›¶ã€‚å¦‚æœçˆ¶å®¹å™¨æ—¢æ²¡æœ‰å›ºå®šçš„widthå’Œheightï¼Œä¹Ÿæ²¡æœ‰è®¾å®šflexï¼Œåˆ™çˆ¶å®¹å™¨çš„å°ºå¯¸ä¸ºé›¶ã€‚å…¶å­ç»„ä»¶å¦‚æœä½¿ç”¨äº†flexï¼Œä¹Ÿæ˜¯æ— æ³•æ˜¾ç¤ºçš„ã€‚
import React, { Component } from 'react';
import { AppRegistry, View } from 'react-native';

export default class FlexDimensionsBasics extends Component {
  render() {
    return (
      // è¯•è¯•å»æ‰çˆ¶Viewä¸­çš„`flex: 1`ã€‚
      // åˆ™çˆ¶Viewä¸å†å…·æœ‰å°ºå¯¸ï¼Œå› æ­¤å­ç»„ä»¶ä¹Ÿæ— æ³•å†æ’‘å¼€ã€‚
      // ç„¶åå†ç”¨`height: 300`æ¥ä»£æ›¿çˆ¶Viewçš„`flex: 1`è¯•è¯•çœ‹ï¼Ÿ
      <View style={{flex: 1}}>
        <View style={{flex: 1, backgroundColor: 'powderblue'}} />
        <View style={{flex: 2, backgroundColor: 'skyblue'}} />
        <View style={{flex: 3, backgroundColor: 'steelblue'}} />
      </View>
    );
  }
};

AppRegistry.registerComponent('AwesomeProject', () => FlexDimensionsBasics);

ä½¿ç”¨Flexboxå¸ƒå±€

æˆ‘ä»¬åœ¨React Nativeä¸­ä½¿ç”¨flexboxè§„åˆ™æ¥æŒ‡å®šæŸä¸ªç»„ä»¶çš„å­å…ƒç´ çš„å¸ƒå±€ã€‚Flexboxå¯ä»¥åœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸Šæä¾›ä¸€è‡´çš„å¸ƒå±€ç»“æ„ã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œä½¿ç”¨flexDirectionã€alignItemså’Œ justifyContentä¸‰ä¸ªæ ·å¼å±æ€§å°±å·²ç»èƒ½æ»¡è¶³å¤§å¤šæ•°å¸ƒå±€éœ€æ±‚
flexDirectionçš„é»˜è®¤å€¼æ˜¯columnè€Œä¸æ˜¯rowï¼Œè€Œflexä¹Ÿåªèƒ½æŒ‡å®šä¸€ä¸ªæ•°å­—å€¼ã€‚

åœ¨ç»„ä»¶çš„styleä¸­æŒ‡å®šflexDirectionå¯ä»¥å†³å®šå¸ƒå±€çš„ä¸»è½´ã€‚å­å…ƒç´ æ˜¯åº”è¯¥æ²¿ç€æ°´å¹³è½´(row)æ–¹å‘æ’åˆ—ï¼Œè¿˜æ˜¯æ²¿ç€ç«–ç›´è½´(column)æ–¹å‘æ’åˆ—å‘¢ï¼Ÿé»˜è®¤å€¼æ˜¯ç«–ç›´è½´(column)æ–¹å‘ã€‚

import React, { Component } from 'react';
import { AppRegistry, View } from 'react-native';

class FlexDirectionBasics extends Component {
  render() {
    return (
      // å°è¯•æŠŠ`flexDirection`æ”¹ä¸º`column`çœ‹çœ‹
      <View style={{flex: 1, flexDirection: 'row'}}>
        <View style={{width: 50, height: 50, backgroundColor: 'powderblue'}} />
        <View style={{width: 50, height: 50, backgroundColor: 'skyblue'}} />
        <View style={{width: 50, height: 50, backgroundColor: 'steelblue'}} />
      </View>
    );
  }
};

AppRegistry.registerComponent('AwesomeProject', () => FlexDirectionBasics);

åœ¨ç»„ä»¶çš„styleä¸­æŒ‡å®šjustifyContentå¯ä»¥å†³å®šå…¶å­å…ƒç´ æ²¿ç€ä¸»è½´çš„æ’åˆ—æ–¹å¼ã€‚å­å…ƒç´ æ˜¯åº”è¯¥é è¿‘ä¸»è½´çš„èµ·å§‹ç«¯è¿˜æ˜¯æœ«å°¾æ®µåˆ†å¸ƒå‘¢ï¼Ÿäº¦æˆ–åº”è¯¥å‡åŒ€åˆ†å¸ƒï¼Ÿå¯¹åº”çš„è¿™äº›å¯é€‰é¡¹æœ‰ï¼šflex-startã€centerã€flex-endã€space-aroundä»¥åŠspace-betweenã€‚
import React, { Component } from 'react';
import { AppRegistry, View } from 'react-native';

export defualt class JustifyContentBasics extends Component {
  render() {
    return (
      // å°è¯•æŠŠ`justifyContent`æ”¹ä¸º`center`çœ‹çœ‹
      // å°è¯•æŠŠ`flexDirection`æ”¹ä¸º`row`çœ‹çœ‹
      <View style={{
        flex: 1,
        flexDirection: 'column',
        justifyContent: 'space-between',
      }}>
        <View style={{width: 50, height: 50, backgroundColor: 'powderblue'}} />
        <View style={{width: 50, height: 50, backgroundColor: 'skyblue'}} />
        <View style={{width: 50, height: 50, backgroundColor: 'steelblue'}} />
      </View>
    );
  }
};

AppRegistry.registerComponent('AwesomeProject', () => JustifyContentBasics);

åœ¨ç»„ä»¶çš„styleä¸­æŒ‡å®šalignItemså¯ä»¥å†³å®šå…¶å­å…ƒç´ æ²¿ç€æ¬¡è½´ï¼ˆä¸ä¸»è½´å‚ç›´çš„è½´ï¼Œæ¯”å¦‚è‹¥ä¸»è½´æ–¹å‘ä¸ºrowï¼Œåˆ™æ¬¡è½´æ–¹å‘ä¸ºcolumnï¼‰çš„æ’åˆ—æ–¹å¼ã€‚å­å…ƒç´ æ˜¯åº”è¯¥é è¿‘æ¬¡è½´çš„èµ·å§‹ç«¯è¿˜æ˜¯æœ«å°¾æ®µåˆ†å¸ƒå‘¢ï¼Ÿäº¦æˆ–åº”è¯¥å‡åŒ€åˆ†å¸ƒï¼Ÿå¯¹åº”çš„è¿™äº›å¯é€‰é¡¹æœ‰ï¼šflex-startã€centerã€flex-endä»¥åŠstretchã€‚

import React, { Component } from 'react';
import { AppRegistry, View } from 'react-native';

class AlignItemsBasics extends Component {
  render() {
    return (
      // å°è¯•æŠŠ`alignItems`æ”¹ä¸º`flex-start`çœ‹çœ‹
      // å°è¯•æŠŠ`justifyContent`æ”¹ä¸º`flex-end`çœ‹çœ‹
      // å°è¯•æŠŠ`flexDirection`æ”¹ä¸º`row`çœ‹çœ‹
      <View style={{
        flex: 1,
        flexDirection: 'column',
        justifyContent: 'center',
        alignItems: 'center',
      }}>
        <View style={{width: 50, height: 50, backgroundColor: 'powderblue'}} />
        <View style={{width: 50, height: 50, backgroundColor: 'skyblue'}} />
        <View style={{width: 50, height: 50, backgroundColor: 'steelblue'}} />
      </View>
    );
  }
};

AppRegistry.registerComponent('AwesomeProject', () => AlignItemsBasics);

æ–‡æœ¬è¾“å…¥
TextInputæ˜¯ä¸€ä¸ªå…è®¸ç”¨æˆ·è¾“å…¥æ–‡æœ¬çš„åŸºç¡€ç»„ä»¶ã€‚å®ƒæœ‰ä¸€ä¸ªåä¸ºonChangeTextçš„å±æ€§ï¼Œæ­¤å±æ€§æ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæ­¤å‡½æ•°ä¼šåœ¨æ–‡æœ¬å˜åŒ–æ—¶è¢«è°ƒç”¨ã€‚å¦å¤–è¿˜æœ‰ä¸€ä¸ªåä¸ºonSubmitEditingçš„å±æ€§

import React, { Component } from 'react';
import { AppRegistry, Text, TextInput, View } from 'react-native';

export default class PizzaTranslator extends Component {
  constructor(props) {
    super(props);
    this.state = {text: ''};
  }

  render() {
    return (
      <View style={{padding: 10}}>
        <TextInput
          style={{height: 40}}
          placeholder="Type here to translate!"
          onChangeText={(text) => this.setState({text})}
        />
        <Text style={{padding: 10, fontSize: 42}}>
          {this.state.text.split(' ').map((word) => word && 'ğŸ•').join(' ')}
        </Text>
      </View>
    );
  }
}

æ»šåŠ¨è§†å›¾
ScrollViewæ˜¯ä¸€ä¸ªé€šç”¨çš„å¯æ»šåŠ¨çš„å®¹å™¨ï¼Œä½ å¯ä»¥åœ¨å…¶ä¸­æ”¾å…¥å¤šä¸ªç»„ä»¶å’Œè§†å›¾ï¼Œè€Œä¸”è¿™äº›ç»„ä»¶å¹¶ä¸éœ€è¦æ˜¯åŒç±»å‹çš„ã€‚ScrollViewä¸ä»…å¯ä»¥å‚ç›´æ»šåŠ¨ï¼Œè¿˜èƒ½æ°´å¹³æ»šåŠ¨ï¼ˆé€šè¿‡horizontalå±æ€§æ¥è®¾ç½®ï¼‰ã€‚
import React, { Component } from 'react';
import{ ScrollView, Image, Text, View } from 'react-native'

export default class IScrolledDownAndWhatHappenedNextShockedMe extends Component {
  render() {
      return(
        <ScrollView>
          <Text style={{fontSize:96}}>Scroll me plz</Text>
          <Image source={require('./img/favicon.png')} />
          <Image source={require('./img/favicon.png')} />
          <Image source={require('./img/favicon.png')} />
          <Image source={require('./img/favicon.png')} />
          <Image source={require('./img/favicon.png')} />
          <Text style={{fontSize:96}}>If you like</Text>
          <Image source={require('./img/favicon.png')} />
          <Image source={require('./img/favicon.png')} />
          <Image source={require('./img/favicon.png')} />
          <Image source={require('./img/favicon.png')} />
          <Image source={require('./img/favicon.png')} />
          <Text style={{fontSize:96}}>Scrolling down</Text>
          <Image source={require('./img/favicon.png')} />
          <Image source={require('./img/favicon.png')} />
          <Image source={require('./img/favicon.png')} />
          <Image source={require('./img/favicon.png')} />
          <Image source={require('./img/favicon.png')} />
          <Text style={{fontSize:80}}>React Native</Text>
        </ScrollView>
    );
  }
}

é•¿åˆ—è¡¨

React Nativeæä¾›äº†å‡ ä¸ªé€‚ç”¨äºå±•ç¤ºé•¿åˆ—è¡¨æ•°æ®çš„ç»„ä»¶ï¼Œä¸€èˆ¬è€Œè¨€æˆ‘ä»¬ä¼šé€‰ç”¨FlatListæˆ–æ˜¯SectionListã€‚

FlatListç»„ä»¶ç”¨äºæ˜¾ç¤ºä¸€ä¸ªå‚ç›´çš„æ»šåŠ¨åˆ—è¡¨ï¼Œå…¶ä¸­çš„å…ƒç´ ä¹‹é—´ç»“æ„è¿‘ä¼¼è€Œä»…æ•°æ®ä¸åŒã€‚

FlatListæ›´é€‚äºé•¿åˆ—è¡¨æ•°æ®ï¼Œä¸”å…ƒç´ ä¸ªæ•°å¯ä»¥å¢åˆ ã€‚å’ŒScrollViewä¸åŒçš„æ˜¯ï¼ŒFlatListå¹¶ä¸ç«‹å³æ¸²æŸ“æ‰€æœ‰å…ƒç´ ï¼Œè€Œæ˜¯ä¼˜å…ˆæ¸²æŸ“å±å¹•ä¸Šå¯è§çš„å…ƒç´ ã€‚

FlatListç»„ä»¶å¿…é¡»çš„ä¸¤ä¸ªå±æ€§æ˜¯dataå’ŒrenderItemã€‚dataæ˜¯åˆ—è¡¨çš„æ•°æ®æºï¼Œè€ŒrenderItemåˆ™ä»æ•°æ®æºä¸­é€ä¸ªè§£ææ•°æ®ï¼Œç„¶åè¿”å›ä¸€ä¸ªè®¾å®šå¥½æ ¼å¼çš„ç»„ä»¶æ¥æ¸²æŸ“ã€‚

ä¸‹é¢çš„ä¾‹å­åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„FlatListï¼Œå¹¶é¢„è®¾äº†ä¸€äº›æ¨¡æ‹Ÿæ•°æ®ã€‚é¦–å…ˆæ˜¯åˆå§‹åŒ–FlatListæ‰€éœ€çš„dataï¼Œå…¶ä¸­çš„æ¯ä¸€é¡¹ï¼ˆè¡Œï¼‰æ•°æ®ä¹‹åéƒ½åœ¨renderItemä¸­è¢«æ¸²æŸ“æˆäº†Textç»„ä»¶ï¼Œæœ€åæ„æˆæ•´ä¸ªFlatListã€‚
import React, { Component } from 'react';
import { FlatList, StyleSheet, Text, View } from 'react-native';

export default class FlatListBasics extends Component {
  render() {
    return (
      <View style={styles.container}>
        <FlatList
          data={[
            {key: 'Devin'},
            {key: 'Jackson'},
            {key: 'James'},
            {key: 'Joel'},
            {key: 'John'},
            {key: 'Jillian'},
            {key: 'Jimmy'},
            {key: 'Julie'},
          ]}
          renderItem={({item}) => <Text style={styles.item}>{item.key}</Text>}
        />
      </View>
    );
  }
}

const styles = StyleSheet.create({
  container: {
   flex: 1,
   paddingTop: 22
  },
  item: {
    padding: 10,
    fontSize: 18,
    height: 44,
  },
})

å¦‚æœè¦æ¸²æŸ“çš„æ˜¯ä¸€ç»„éœ€è¦åˆ†ç»„çš„æ•°æ®ï¼Œä¹Ÿè®¸è¿˜å¸¦æœ‰åˆ†ç»„æ ‡ç­¾çš„ï¼Œé‚£ä¹ˆSectionListå°†æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©.

import React, { Component } from 'react';
import { SectionList, StyleSheet, Text, View } from 'react-native';

export default class SectionListBasics extends Component {
  render() {
    return (
      <View style={styles.container}>
        <SectionList
          sections={[
            {title: 'D', data: ['Devin']},
            {title: 'J', data: ['Jackson', 'James', 'Jillian', 'Jimmy', 'Joel', 'John', 'Julie']},
          ]}
          renderItem={({item}) => <Text style={styles.item}>{item}</Text>}
          renderSectionHeader={({section}) => <Text style={styles.sectionHeader}>{section.title}</Text>}
        />
      </View>
    );
  }
}

const styles = StyleSheet.create({
  container: {
   flex: 1,
   paddingTop: 22
  },
  sectionHeader: {
    paddingTop: 2,
    paddingLeft: 10,
    paddingRight: 10,
    paddingBottom: 2,
    fontSize: 14,
    fontWeight: 'bold',
    backgroundColor: 'rgba(247,247,247,1.0)',
  },
  item: {
    padding: 10,
    fontSize: 18,
    height: 44,
  },
})

ç½‘ç»œ
å‘èµ·ç½‘ç»œè¯·æ±‚ è¦ä»ä»»æ„åœ°å€è·å–å†…å®¹çš„è¯ï¼Œåªéœ€ç®€å•åœ°å°†ç½‘å€ä½œä¸ºå‚æ•°ä¼ é€’ç»™fetchæ–¹æ³•å³å¯
fetch('https://mywebsite.com/mydata.json')

fetch('https://mywebsite.com/endpoint/', {
  method: 'POST',
  headers: {
    'Accept': 'application/json',
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    firstParam: 'yourValue',
    secondParam: 'yourOtherValue',
  })
})

fetch apiæ–‡æ¡£ https://developer.mozilla.org/en-US/docs/Web/API/Request

å¼‚æ­¥
getMoviesFromApiAsync() {
    return fetch('https://facebook.github.io/react-native/movies.json')
      .then((response) => response.json())
      .then((responseJson) => {
        return responseJson.movies;
      })
      .catch((error) => {
        console.error(error);
      });
  }

  ä¹Ÿå¯ä»¥
  // æ³¨æ„è¿™ä¸ªæ–¹æ³•å‰é¢æœ‰asyncå…³é”®å­—
  async getMoviesFromApi() {
    try {
      // æ³¨æ„è¿™é‡Œçš„awaitè¯­å¥ï¼Œå…¶æ‰€åœ¨çš„å‡½æ•°å¿…é¡»æœ‰asyncå…³é”®å­—å£°æ˜
      let response = await fetch('https://facebook.github.io/react-native/movies.json');
      let responseJson = await response.json();
      return responseJson.movies;
    } catch(error) {
      console.error(error);
    }
  }

  React Nativeä¸­å·²ç»å†…ç½®äº†XMLHttpRequest API(ä¹Ÿå°±æ˜¯ä¿—ç§°çš„ajax)ã€‚

  var request = new XMLHttpRequest();
request.onreadystatechange = (e) => {
  if (request.readyState !== 4) {
    return;
  }

  if (request.status === 200) {
    console.log('success', request.responseText);
  } else {
    console.warn('error');
  }
};

request.open('GET', 'https://mywebsite.com/endpoint/');
request.send();

WebSocketæ”¯æŒ
React Nativeè¿˜æ”¯æŒWebSocketï¼Œè¿™ç§åè®®å¯ä»¥åœ¨å•ä¸ªTCPè¿æ¥ä¸Šæä¾›å…¨åŒå·¥çš„é€šä¿¡ä¿¡é“ã€‚

var ws = new WebSocket('ws://host.com/path');

ws.onopen = () => {
  // æ‰“å¼€ä¸€ä¸ªè¿æ¥

  ws.send('something'); // å‘é€ä¸€ä¸ªæ¶ˆæ¯
};

ws.onmessage = (e) => {
  // æ¥æ”¶åˆ°äº†ä¸€ä¸ªæ¶ˆæ¯
  console.log(e.data);
};

ws.onerror = (e) => {
  // å‘ç”Ÿäº†ä¸€ä¸ªé”™è¯¯
  console.log(e.message);
};

ws.onclose = (e) => {
  // è¿æ¥è¢«å…³é—­äº†
  console.log(e.code, e.reason);
};

React Navigation

å®‰è£…ï¼šyarn add react-navigation

ç„¶åä½ å°±å¯ä»¥å¿«é€Ÿåˆ›å»ºä¸€ä¸ªæœ‰ä¸¤ä¸ªé¡µé¢ï¼ˆMainå’ŒProfileï¼‰çš„åº”ç”¨äº†ï¼š

import {
  StackNavigator,
} from 'react-navigation';

const App = StackNavigator({
  Main: {screen: MainScreen},
  Profile: {screen: ProfileScreen},
});

å…¶ä¸­æ¯ä¸€ä¸ªscreenç»„ä»¶éƒ½å¯ä»¥å•ç‹¬è®¾ç½®å¯¼èˆªé€‰é¡¹ï¼Œä¾‹å¦‚å¯¼èˆªå¤´çš„æ ‡é¢˜ã€‚è¿˜å¯ä»¥ä½¿ç”¨navigationå±æ€§ä¸­çš„æ–¹æ³•å»è·³è½¬åˆ°åˆ«çš„é¡µé¢ï¼š

class MainScreen extends React.Component {
  static navigationOptions = {
    title: 'Welcome',
  };
  render() {
    const { navigate } = this.props.navigation;
    return (
      <Button
        title="Go to Jane's profile"
        onPress={() =>
          navigate('Profile', { name: 'Jane' });
        }
      />
    );
  }
}

é¢œè‰²
'#f0f' (#rgb)
'#f0fc' (#rgba)
'#ff00ff' (#rrggbb)
'#ff00ff00' (#rrggbbaa)
'rgb(255, 255, 255)'
'rgba(255, 255, 255, 1.0)'
'hsl(360, 100%, 100%)'
'hsla(360, 100%, 100%, 1.0)'
'transparent'
'red'
0xff00ff00 (0xrrggbbaa)
éƒ½æ”¯æŒ

é™æ€å›¾ç‰‡
Image source={require('./my-icon.png')} />

<Image source={{uri: 'app_icon'}} style={{width: 40, height: 40}} />

å¯¹äºæ”¾ç½®åœ¨Androidçš„assetsç›®å½•ä¸­çš„å›¾ç‰‡ï¼Œè¿˜å¯ä»¥ä½¿ç”¨asset:/ å‰ç¼€æ¥å¼•ç”¨ï¼š

<Image source={{uri: 'asset:/app_icon.png'}} style={{width: 40, height: 40}} />

ç½‘ç»œå›¾ç‰‡éœ€è¦æ‰‹åŠ¨æŒ‡å®šå›¾ç‰‡çš„å°ºå¯¸
<Image source={{uri: 'https://facebook.github.io/react/img/logo_og.png'}}
       style={{width: 400, height: 400}} />

       <Image source={{
         uri: 'https://facebook.github.io/react/img/logo_og.png',
         method: 'POST',
         headers: {
           Pragma: 'no-cache'
         },
         body: 'Your Body goes here'
       }}
       style={{width: 400, height: 400}} />


ç‚¹å‡»äº‹ä»¶
class MyButton extends Component {
  _onPressButton() {
    console.log("You tapped the button!");
  }

  render() {
    return (
      <TouchableHighlight onPress={this._onPressButton}>
        <Text>Button</Text>
      </TouchableHighlight>
    );
  }
}

åŠ¨ç”»
React Nativeæä¾›äº†ä¸¤ä¸ªäº’è¡¥çš„åŠ¨ç”»ç³»ç»Ÿï¼šç”¨äºå…¨å±€çš„å¸ƒå±€åŠ¨ç”»LayoutAnimationï¼Œå’Œç”¨äºåˆ›å»ºæ›´ç²¾ç»†çš„äº¤äº’æ§åˆ¶çš„åŠ¨ç”»Animatedã€‚
Animatedæ—¨åœ¨ä»¥å£°æ˜çš„å½¢å¼æ¥å®šä¹‰åŠ¨ç”»çš„è¾“å…¥ä¸è¾“å‡ºï¼Œåœ¨å…¶ä¸­å»ºç«‹ä¸€ä¸ªå¯é…ç½®çš„å˜åŒ–å‡½æ•°ï¼Œç„¶åä½¿ç”¨ç®€å•çš„start/stopæ–¹æ³•æ¥æ§åˆ¶åŠ¨ç”»æŒ‰é¡ºåºæ‰§è¡Œã€‚ Animatedä»…å°è£…äº†å››ä¸ªå¯ä»¥åŠ¨ç”»åŒ–çš„ç»„ä»¶ï¼šViewã€Textã€Imageå’ŒScrollViewï¼Œä¸è¿‡ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨Animated.createAnimatedComponent()æ¥å°è£…ä½ è‡ªå·±çš„ç»„ä»¶ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨åŠ è½½æ—¶å¸¦æœ‰æ·¡å…¥åŠ¨ç”»æ•ˆæœçš„è§†å›¾ï¼š
// FadeInView.js
import React, { Component } from 'react';
import {
  Animated,
} from 'react-native';

export default class FadeInView extends Component {
  constructor(props) {
    super(props);
    this.state = {
      fadeAnim: new Animated.Value(0),          // é€æ˜åº¦åˆå§‹å€¼è®¾ä¸º0
    };
  }
  componentDidMount() {
    Animated.timing(                            // éšæ—¶é—´å˜åŒ–è€Œæ‰§è¡Œçš„åŠ¨ç”»ç±»å‹
      this.state.fadeAnim,                      // åŠ¨ç”»ä¸­çš„å˜é‡å€¼
      {
        toValue: 1,                             // é€æ˜åº¦æœ€ç»ˆå˜ä¸º1ï¼Œå³å®Œå…¨ä¸é€æ˜
      }
    ).start();                                  // å¼€å§‹æ‰§è¡ŒåŠ¨ç”»
  }
  render() {
    return (
      <Animated.View                            // å¯åŠ¨ç”»åŒ–çš„è§†å›¾ç»„ä»¶
        style={{
          ...this.props.style,
          opacity: this.state.fadeAnim,          // å°†é€æ˜åº¦æŒ‡å®šä¸ºåŠ¨ç”»å˜é‡å€¼
        }}
      >
        {this.props.children}
      </Animated.View>
    );
  }
}

render() {
  return (
    <FadeInView style={{width: 250, height: 50, backgroundColor: 'powderblue'}}>
      <Text style={{fontSize: 28, textAlign: 'center', margin: 10}}>Fading in</Text>
    </FadeInView>
  )
}
åœ¨FadeInViewçš„æ„é€ å‡½æ•°é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸ºfadeAnimçš„Animated.Valueï¼Œå¹¶æ”¾åœ¨stateä¸­ã€‚ è€ŒViewçš„é€æ˜åº¦æ˜¯å’Œè¿™ä¸ªå€¼ç»‘å®šçš„ã€‚

é…ç½®åŠ¨ç”»
Animated.timing(
  this.state.xPosition,
  {
    toValue: 100,
    easing: Easing.back,
    duration: 2000,
  }
).start();

ç»„åˆåŠ¨ç”»
å¤šä¸ªåŠ¨ç”»å¯ä»¥é€šè¿‡parallelï¼ˆåŒæ—¶æ‰§è¡Œï¼‰ã€sequenceï¼ˆé¡ºåºæ‰§è¡Œï¼‰ã€staggerå’Œdelayæ¥ç»„åˆä½¿ç”¨ã€‚å®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªéƒ½æ¥å—ä¸€ä¸ªè¦æ‰§è¡Œçš„åŠ¨ç”»æ•°ç»„ï¼Œå¹¶ä¸”è‡ªåŠ¨åœ¨é€‚å½“çš„æ—¶å€™è°ƒç”¨start/stopã€‚ä¸¾ä¸ªä¾‹å­ï¼š

Animated.sequence([            // é¦–å…ˆæ‰§è¡ŒdecayåŠ¨ç”»ï¼Œç»“æŸååŒæ—¶æ‰§è¡Œspringå’ŒtwirlåŠ¨ç”»
  Animated.decay(position, {   // æ»‘è¡Œä¸€æ®µè·ç¦»ååœæ­¢
    velocity: {x: gestureState.vx, y: gestureState.vy}, // æ ¹æ®ç”¨æˆ·çš„æ‰‹åŠ¿è®¾ç½®é€Ÿåº¦
    deceleration: 0.997,
  }),
  Animated.parallel([          // åœ¨decayä¹‹åå¹¶è¡Œæ‰§è¡Œï¼š
    Animated.spring(position, {
      toValue: {x: 0, y: 0}    // è¿”å›åˆ°èµ·å§‹ç‚¹å¼€å§‹
    }),
    Animated.timing(twirl, {   // åŒæ—¶å¼€å§‹æ—‹è½¬
      toValue: 360,
    }),
  ]),
]).start();                    // æ‰§è¡Œè¿™ä¸€æ•´å¥—åŠ¨ç”»åºåˆ—

åˆæˆåŠ¨ç”»å€¼
ä½ å¯ä»¥ä½¿ç”¨åŠ å‡ä¹˜é™¤ä»¥åŠå–ä½™ç­‰è¿ç®—æ¥æŠŠä¸¤ä¸ªåŠ¨ç”»å€¼åˆæˆä¸ºä¸€ä¸ªæ–°çš„åŠ¨ç”»å€¼ã€‚

There are some cases where an animated value needs to invert another animated value for calculation. An example is inverting a scale (2x --> 0.5x):

const a = Animated.Value(1);
const b = Animated.divide(1, a);

Animated.spring(a, {
  toValue: 2,
}).start();

æ’å€¼
Animated APIè¿˜æœ‰ä¸€ä¸ªå¾ˆå¼ºå¤§çš„éƒ¨åˆ†å°±æ˜¯interpolateæ’å€¼å‡½æ•°ã€‚å®ƒå¯ä»¥æ¥å—ä¸€ä¸ªè¾“å…¥åŒºé—´ï¼Œç„¶åå°†å…¶æ˜ å°„åˆ°å¦ä¸€ä¸ªçš„è¾“å‡ºåŒºé—´ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¸€ä¸ªç®€å•çš„ä»0-1åŒºé—´åˆ°0-100åŒºé—´çš„æ˜ å°„ç¤ºä¾‹ï¼š
value.interpolate({
  inputRange: [0, 1],
  outputRange: [0, 100],
});

interpolateè¿˜æ”¯æŒå®šä¹‰å¤šä¸ªåŒºé—´æ®µè½ï¼Œå¸¸ç”¨æ¥å®šä¹‰é™æ­¢åŒºé—´ç­‰ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè¦è®©è¾“å…¥åœ¨æ¥è¿‘-300æ—¶å–ç›¸åå€¼ï¼Œç„¶ååœ¨è¾“å…¥æ¥è¿‘-100æ—¶åˆ°è¾¾0ï¼Œç„¶ååœ¨è¾“å…¥æ¥è¿‘0æ—¶åˆå›åˆ°1ï¼Œæ¥ç€ä¸€ç›´åˆ°è¾“å…¥åˆ°100çš„è¿‡ç¨‹ä¸­é€æ­¥å›åˆ°0ï¼Œæœ€åå½¢æˆä¸€ä¸ªå§‹ç»ˆä¸º0çš„é™æ­¢åŒºé—´ï¼Œå¯¹äºä»»ä½•å¤§äº100çš„è¾“å…¥éƒ½è¿”å›0ã€‚å…·ä½“å†™æ³•å¦‚ä¸‹ï¼š

value.interpolate({
  inputRange: [-300, -100, 0, 100, 101],
  outputRange: [300,    0, 1,   0,   0],
});

äº‹ä»¶
onScroll={Animated.event(
  [{nativeEvent: {contentOffset: {x: scrollX}}}]   // scrollX = e.nativeEvent.contentOffset.x
)}
onPanResponderMove={Animated.event([
  null,                                          // å¿½ç•¥åŸç”Ÿäº‹ä»¶
  {dx: pan.x, dy: pan.y}                         // ä»gestureStateä¸­è§£æå‡ºdxå’Œdyçš„å€¼
]);

ä½¿ç”¨åŸç”ŸåŠ¨ç”»é©±åŠ¨
Animated.timing(this.state.animatedValue, {
  toValue: 1,
  duration: 500,
  useNativeDriver: true, // <-- åŠ ä¸Šè¿™ä¸€è¡Œ
}).start();

LayoutAnimation

LayoutAnimationå…è®¸ä½ åœ¨å…¨å±€èŒƒå›´å†…åˆ›å»ºå’Œæ›´æ–°åŠ¨ç”»ï¼Œè¿™äº›åŠ¨ç”»ä¼šåœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“æˆ–å¸ƒå±€å‘¨æœŸè¿è¡Œã€‚å®ƒå¸¸ç”¨æ¥æ›´æ–°flexboxå¸ƒå±€ï¼Œå› ä¸ºå®ƒå¯ä»¥æ— éœ€æµ‹é‡æˆ–è€…è®¡ç®—ç‰¹å®šå±æ€§å°±èƒ½ç›´æ¥äº§ç”ŸåŠ¨ç”»ã€‚å°¤å…¶æ˜¯å½“å¸ƒå±€å˜åŒ–å¯èƒ½å½±å“åˆ°çˆ¶èŠ‚ç‚¹ï¼ˆè­¬å¦‚â€œæŸ¥çœ‹æ›´å¤šâ€å±•å¼€åŠ¨ç”»æ—¢å¢åŠ çˆ¶èŠ‚ç‚¹çš„å°ºå¯¸åˆä¼šå°†ä½äºæœ¬è¡Œä¹‹ä¸‹çš„æ‰€æœ‰è¡Œå‘ä¸‹æ¨åŠ¨ï¼‰æ—¶ï¼Œå¦‚æœä¸ä½¿ç”¨LayoutAnimationï¼Œå¯èƒ½å°±éœ€è¦æ˜¾å¼å£°æ˜ç»„ä»¶çš„åæ ‡ï¼Œæ‰èƒ½ä½¿å¾—æ‰€æœ‰å—å½±å“çš„ç»„ä»¶èƒ½å¤ŸåŒæ­¥è¿è¡ŒåŠ¨ç”»ã€‚

å¦‚æœè¦åœ¨Androidä¸Šä½¿ç”¨LayoutAnimationï¼Œé‚£ä¹ˆç›®å‰è¿˜éœ€è¦åœ¨UIManagerä¸­å¯ç”¨ï¼š
UIManager.setLayoutAnimationEnabledExperimental && UIManager.setLayoutAnimationEnabledExperimental(true);

import React from 'react';
import {
  NativeModules,
  LayoutAnimation,
  Text,
  TouchableOpacity,
  StyleSheet,
  View,
} from 'react-native';

const { UIManager } = NativeModules;

UIManager.setLayoutAnimationEnabledExperimental &&
  UIManager.setLayoutAnimationEnabledExperimental(true);

export default class App extends React.Component {
  state = {
    w: 100,
    h: 100,
  };

  _onPress = () => {
    // Animate the update
    LayoutAnimation.spring();
    this.setState({w: this.state.w + 15, h: this.state.h + 15})
  }

  render() {
    return (
      <View style={styles.container}>
        <View style={[styles.box, {width: this.state.w, height: this.state.h}]} />
        <TouchableOpacity onPress={this._onPress}>
          <View style={styles.button}>
            <Text style={styles.buttonText}>Press me!</Text>
          </View>
        </TouchableOpacity>
      </View>
    );
  }
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: 'center',
    justifyContent: 'center',
  },
  box: {
    width: 200,
    height: 200,
    backgroundColor: 'red',
  },
  button: {
    backgroundColor: 'black',
    paddingHorizontal: 20,
    paddingVertical: 15,
    marginTop: 15,
  },
  buttonText: {
    color: '#fff',
    fontWeight: 'bold',
  },
});

accessible æ— éšœç¢å±æ€§

è®¾ç½®ä¸ºtrueæ—¶è¡¨ç¤ºå½“å‰è§†å›¾æ˜¯ä¸€ä¸ªâ€œæ— éšœç¢å…ƒç´ â€ï¼ˆaccessibility elementï¼‰ã€‚æ— éšœç¢å…ƒç´ ä¼šå°†å…¶æ‰€æœ‰å­ç»„ä»¶è§†ä¸ºä¸€æ•´ä¸ªå¯ä»¥é€‰ä¸­çš„ç»„ä»¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å¯ç‚¹å‡»çš„ç»„ä»¶ï¼ˆTouchableç³»åˆ—ç»„ä»¶ï¼‰éƒ½æ˜¯æ— éšœç¢å…ƒç´ ã€‚

åœ¨Androidä¸Šï¼ŒReact Nativeè§†å›¾çš„â€˜accessible={true}â€™å±æ€§ä¼šè¢«è½¬è¯‘ä¸ºåŸç”Ÿè§†å›¾å¯¹åº”çš„â€˜focusable={true}â€™å±æ€§ã€‚

<View accessible={true}>
  <Text>text one</Text>
  <Text >text two</Text>
</View>
åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“çˆ¶è§†å›¾å¼€å¯æ— éšœç¢å±æ€§åï¼Œæˆ‘ä»¬å°±æ— æ³•å•ç‹¬é€‰ä¸­'text one'å’Œ'text two'ï¼Œè€Œåªèƒ½é€‰ä¸­æ•´ä¸ªçˆ¶è§†å›¾ã€‚

æ— éšœç¢æ ‡ç­¾accessibilityLabel

è®¾å®šaccessibilityLabelå±æ€§å¹¶èµ‹äºˆä¸€ä¸ªå­—ç¬¦ä¸²å†…å®¹å³å¯åœ¨è§†å›¾ä¸­å¯ç”¨æ— éšœç¢æ ‡ç­¾ï¼š

<TouchableOpacity accessible={true} accessibilityLabel={'Tap me!'} onPress={this._onPress}>
  <View style={styles.button}>
    <Text style={styles.buttonText}>Press me!</Text>
  </View>
</TouchableOpacity>
åœ¨ä¸Šé¢è¿™æ®µç¤ºä¾‹ä»£ç ä¸­ï¼Œå¦‚æœä¸åœ¨TouchableOpacityä¸Šè®¾ç½®æ— éšœç¢æ ‡ç­¾ï¼Œé‚£ä¹ˆå…¶é»˜è®¤å€¼å°±ä¼šæ˜¯"Press me!"ï¼ˆå³Textå­ç»„ä»¶çš„æ–‡æœ¬å€¼ï¼‰ã€‚æ­¤æ—¶æ— éšœç¢æ ‡ç­¾æ˜¯é€šè¿‡è‡ªåŠ¨å–æ‰€æœ‰Textå­èŠ‚ç‚¹çš„å€¼ï¼Œç„¶åç”¨ç©ºæ ¼è¿èµ·æ¥ç”Ÿæˆã€‚

æ— éšœç¢å…ƒç´ ç‰¹æ€§accessibilityTraits (iOS)
æ— éšœç¢å…ƒç´ ç‰¹æ€§å¯ä»¥ä½¿VoiceOverçš„ç”¨æˆ·çŸ¥é“è‡ªå·±é€‰ä¸­çš„æ˜¯ä»€ä¹ˆç±»å‹çš„å…ƒç´ ã€‚æ˜¯æ–‡æœ¬æ ‡ç­¾ï¼Ÿæ˜¯æŒ‰é’®ï¼Ÿè¿˜æ˜¯å¤´éƒ¨ï¼ŸaccessibilityTraitså›ç­”äº†è¿™ä¸€é—®é¢˜ã€‚

è®¾å®šaccessibilityTraitså±æ€§å¹¶èµ‹äºˆä»¥ä¸‹ä¸€ä¸ªæˆ–å¤šä¸ªï¼ˆä»¥æ•°ç»„çš„å½¢å¼ï¼‰ç‰¹æ€§å­—ç¬¦ä¸²å³å¯å¯ç”¨æ— éšœç¢å…ƒç´ ç‰¹æ€§ï¼š

none æ— ç‰¹æ€§å…ƒç´ ã€‚
button å…·æœ‰æŒ‰é’®ç‰¹æ€§ã€‚
link å…·æœ‰é“¾æ¥ç‰¹æ€§ã€‚
header ä½œä¸ºå†…å®¹åŒºåŸŸçš„å¤´éƒ¨ï¼ˆæ¯”å¦‚å¯¼èˆªæ çš„æ ‡é¢˜ï¼‰ã€‚
search ç”¨ä½œæœç´¢æ¡†çš„æ–‡æœ¬æ¡†ã€‚
image å…·æœ‰å›¾ç‰‡ç‰¹æ€§ã€‚å¯ä»¥å’ŒæŒ‰é’®æˆ–é“¾æ¥ç­‰è¿ç”¨ã€‚
selected å…ƒç´ è¢«é€‰ä¸­æ—¶ä½¿ç”¨ã€‚æ¯”å¦‚è¡¨æ ¼ä¸­è¢«é€‰ä¸­çš„ä¸€è¡Œæˆ–æ˜¯segmented controlä¸­è¢«é€‰ä¸­çš„ä¸€ä¸ªæŒ‰é’®ã€‚
plays åœ¨å…ƒç´ è¢«ç‚¹å‡»åæ’­æ”¾éŸ³æ•ˆæ—¶ä½¿ç”¨ã€‚
key å…ƒç´ ä½œä¸ºè™šæ‹Ÿé”®ç›˜çš„ä¸€ä¸ªé”®ä½¿ç”¨ã€‚
text å…·æœ‰ä¸å¯ä¿®æ”¹çš„æ–‡æœ¬çš„ç‰¹æ€§ã€‚
summary åœ¨Appå†·å¯åŠ¨ï¼ˆæŒ‡å®Œå…¨é€€å‡ºåå°åå†è¿›å…¥ï¼‰æ—¶æä¾›å½“å‰çš„ç®€è¦æ€»ç»“ä¿¡æ¯çš„å…ƒç´ ã€‚æ¯”å¦‚å½“å¤©æ°”åº”ç”¨å†·å¯åŠ¨æ—¶ï¼Œæ˜¾ç¤ºå½“å‰å¤©æ°”æƒ…å†µçš„å…ƒç´ å°±ä¼šè¢«æ ‡è®°ä¸ºsummaryã€‚
disabled åœ¨å…ƒç´ è¢«ç¦ç”¨ï¼Œä¸æ¥å—ç”¨æˆ·è¾“å…¥æ—¶ä½¿ç”¨ã€‚
frequentUpdates æœ‰äº›å…ƒç´ ä¼šé¢‘ç¹æ›´æ–°å…¶æ ‡ç­¾æˆ–å€¼ï¼Œä½†æˆ‘ä»¬åˆä¸å¸Œæœ›å¤ªé¢‘ç¹åœ°æ¥å—åˆ°é€šçŸ¥ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨è¿™ä¸€ç‰¹æ€§æ ‡è®°ã€‚è¿™ä¸€ç‰¹æ€§æ ‡è®°ä¼šä½¿æ— éšœç¢åŠŸèƒ½çš„å®¢æˆ·ç«¯éš”ä¸€æ®µæ—¶é—´åå†å»æ£€æŸ¥å˜åŒ–ï¼ˆé¿å…é¢‘ç¹æ‰“æ‰°ç”¨æˆ·ï¼‰ã€‚ç§’è¡¨å°±æ˜¯ä¸ªå…¸å‹çš„ä¾‹å­ã€‚
startsMedia åœ¨å…ƒç´ å¯åŠ¨ä¸€ä¸ªå¤šåª’ä½“ä¼šè¯æ—¶ä½¿ç”¨ï¼ˆæ¯”å¦‚æ’­æ”¾ç”µå½±æˆ–æ˜¯å½•éŸ³ï¼‰ï¼Œæ­¤æ—¶ä¸åº”è¯¥è¢«VoiceOverè¿™æ ·çš„è¾…åŠ©æŠ€æœ¯æ‰“æ–­ã€‚
adjustable å…ƒç´ å…·æœ‰å¯è°ƒæ•´çš„ç‰¹æ€§ï¼ˆæ¯”å¦‚ä¸€ä¸ªæ»‘å—ï¼‰ã€‚
allowsDirectInteraction åœ¨å…ƒç´ å¯ä»¥æ¥å—VoiceOverç”¨æˆ·çš„ç›´æ¥è§¦æ‘¸äº¤äº’æ—¶ä½¿ç”¨ï¼ˆæ¯”å¦‚å±•ç¤ºé’¢ç´é”®ç›˜çš„è§†å›¾ï¼‰ã€‚
pageTurn ç”¨äºé€šçŸ¥VoiceOverå½“å‰é¡µé¢å·²ç»é˜…è¯»å®Œæ¯•ï¼Œå¯ä»¥æ»šåŠ¨åˆ°ä¸‹ä¸€ä¸ªé¡µé¢äº†ã€‚
æ— éšœç¢å…ƒç´ çš„ç‚¹å‡»äº‹ä»¶onAccessibilityTap (iOS)
ä½¿ç”¨è¿™ä¸€å±æ€§æ¥ç»‘å®šä¸€ä¸ªè‡ªå®šä¹‰çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè¿™ä¸€å‡½æ•°ä¼šåœ¨å½“ç”¨æˆ·åŒå‡»æŸä¸ªå·²ç»é€‰ä¸­çš„æ— éšœç¢å…ƒç´ æ—¶è°ƒç”¨ã€‚

MagicTapåŒæŒ‡åŒå‡»äº‹ä»¶onMagicTap (iOS)
ä½¿ç”¨è¿™ä¸€å±æ€§æ¥ç»‘å®šä¸€ä¸ªè‡ªå®šä¹‰çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè¿™ä¸€å‡½æ•°ä¼šåœ¨å½“ç”¨æˆ·æ‰§è¡Œ"magic tap"æ“ä½œï¼ˆå³ä½¿ç”¨ä¸¤ä¸ªæŒ‡å¤´æ¥åŒå‡»ï¼‰æ—¶è°ƒç”¨ã€‚magic tapçš„äº‹ä»¶å¤„ç†å‡½æ•°åº”è¯¥åšä¸å½“å‰ç»„ä»¶ç›¸å…³æ€§æœ€é«˜çš„æ“ä½œï¼Œæ¯”å¦‚åœ¨ç”µè¯åº”ç”¨ä¸­ï¼Œmagic tapçš„æ“ä½œå°±åº”è¯¥æ¥é€šç”µè¯ï¼Œæˆ–æ˜¯æŒ‚æ–­å·²ç»æ¥é€šçš„ç”µè¯ã€‚å¦‚æœå½“å‰é€‰ä¸­çš„å…ƒç´ å¹¶æ²¡æœ‰onMagicTapå‡½æ•°ï¼Œåˆ™ç³»ç»Ÿä¼šè‡ªåŠ¨éå†è§†å›¾å±‚ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥å“åº”æ­¤æ“ä½œçš„ã€‚

æ— éšœç¢ç»„ä»¶ç±»å‹accessibilityComponentType (Android)
åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿå¸Œæœ›å‘ŠçŸ¥ç”¨æˆ·ä»–é€‰ä¸­çš„ç»„ä»¶çš„ç±»å‹ï¼ˆæ¯”å¦‚æ˜¯ä¸ªæŒ‰é’®ï¼‰ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯åŸç”ŸæŒ‰é’®ï¼Œè¿™ä¸€è¡Œä¸ºä¼šè‡ªåŠ¨è¿›è¡Œã€‚ä½†æ—¢ç„¶æˆ‘ä»¬ä¸»è¦æ˜¯ä½¿ç”¨javascriptï¼Œåˆ™è¿˜éœ€è¦ä¸ºAndroidçš„TalkBackæŠ€æœ¯æä¾›æ›´å¤šä¿¡æ¯ã€‚è¦å®ç°è¿™ä¸€ç‚¹ï¼Œå°±å¿…é¡»ä¸ºæ‰€æœ‰UIç»„ä»¶æŒ‡å®šaccessibilityComponentTypeå±æ€§ã€‚æ¯”å¦‚å¯ä»¥æŒ‡å®šbuttonï¼Œradiobutton_checkedä»¥åŠradiobutton_uncheckedç­‰å€¼ã€‚

<TouchableWithoutFeedback accessibilityComponentType=â€buttonâ€
  onPress={this._onPress}>
  <View style={styles.button}>
    <Text style={styles.buttonText}>Press me!</Text>
  </View>
</TouchableWithoutFeedback>
ä¸Šé¢è¿™ä¸ªä¾‹å­é‡Œï¼ŒTouchableWithoutFeedbackåœ¨TalkBackä¸­è¢«å£°æ˜ä¸ºä¸€ä¸ªåŸç”ŸæŒ‰é’®ã€‚

æ— éšœç¢çš„åŠ¨æ€åŒºåŸŸaccessibilityLiveRegion (Android)
ç»„ä»¶å‘ç”ŸåŠ¨æ€å˜åŒ–æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›TalkBackèƒ½å¤Ÿæé†’ç”¨æˆ·ã€‚è¿™ä¸€è¡Œä¸ºå¯ä»¥é€šè¿‡è®¾ç½®accessibilityLiveRegionå±æ€§æ¥å®ç°ã€‚å…·ä½“å€¼å¯ä»¥è®¾ç½®ä¸ºnoneï¼Œpoliteä»¥åŠassertiveï¼š

none è¾…åŠ©æœåŠ¡ä¸åº”è¯¥æé†’ç”¨æˆ·å½“å‰è§†å›¾çš„å˜åŒ–ã€‚
polite è¾…åŠ©æœåŠ¡åº”è¯¥æé†’ç”¨æˆ·å½“å‰è§†å›¾çš„å˜åŒ–ã€‚
assertive è¾…åŠ©æœåŠ¡åº”è¯¥ç«‹å³æ‰“æ–­å½“å‰çš„è¯­éŸ³ä¼šè¯ï¼Œæé†’ç”¨æˆ·å½“å‰è§†å›¾çš„å˜åŒ–ã€‚
<TouchableWithoutFeedback onPress={this._addOne}>
  <View style={styles.embedded}>
    <Text>Click me</Text>
  </View>
</TouchableWithoutFeedback>
<Text accessibilityLiveRegion="polite">
  Clicked {this.state.count} times
</Text>
ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œ_addOneæ–¹æ³•ä¼šæ”¹å˜state.countè¿™ä¸ªå˜é‡ã€‚é‚£ä¹ˆåªè¦ç”¨æˆ·ç‚¹å‡»äº† TouchableWithoutFeedbackï¼ŒTalkBackå°±ä¼šè¯»å‡ºTextç»„ä»¶ä¸­çš„å€¼ï¼Œå› ä¸ºå®ƒè®¾ç½®äº†accessibilityLiveRegion=â€politeâ€å±æ€§ã€‚

æ— éšœç¢åŠŸèƒ½ä¼˜å…ˆçº§importantForAccessibility (Android)
å¦‚æœæœ‰ä¸¤ä¸ªUIç»„ä»¶åŒæ—¶å±‚å è¦†ç›–åœ¨çˆ¶è§†å›¾ä¹‹ä¸Šï¼Œé‚£ä¹ˆé»˜è®¤çš„æ— éšœç¢åŠŸèƒ½çš„ç„¦ç‚¹ä½ç½®å°±å¯èƒ½éš¾ä»¥é¢„æ–™ã€‚importantForAccessibilityå±æ€§è§£å†³äº†è¿™ä¸€é—®é¢˜ï¼Œå®ƒå¯ä»¥æ§åˆ¶æŸä¸ªè§†å›¾æ˜¯å¦è§¦å‘æ— éšœç¢åŠŸèƒ½äº‹ä»¶ï¼Œä»¥åŠæ˜¯å¦å°†å…¶æŠ¥å‘Šç»™è¾…åŠ©æœåŠ¡ã€‚å…·ä½“å€¼å¯ä»¥è®¾ç½®ä¸ºautoï¼Œyesï¼Œnoå’Œno-hide-descendantsï¼ˆæœ€åä¸€ä¸ªå€¼ä¼šå¼ºåˆ¶è¾…åŠ©æœåŠ¡å¿½ç•¥å½“å‰ç»„ä»¶åŠå…¶æ‰€æœ‰å­ç»„ä»¶ï¼‰ã€‚

<View style={styles.container}>
  <View style={{position: 'absolute', left: 10, top: 10, right: 10, height: 100,
    backgroundColor: 'green'}} importantForAccessibility=â€yesâ€>
    <Text> First layout </Text>
  </View>
  <View style={{position: 'absolute', left: 10, top: 10, right: 10, height: 100,
    backgroundColor: 'yellow'}} importantForAccessibility=â€no-hide-descendantâ€>
    <Text> Second layout </Text>
  </View>
</View>
ä¸Šé¢è¿™ä¸ªä¾‹å­é‡Œï¼Œç¬¬äºŒä¸ªViewçš„ç»„ä»¶å¯¹äºTalkBackå’Œå…¶ä»–ä¸€äº›è¾…åŠ©æœåŠ¡æ¥è¯´æ˜¯å®Œå…¨ä¸å¯è§çš„ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è½»æ˜“åœ°æŠŠä¸¤ä¸ªè§†å›¾è¦†ç›–åˆ°åŒä¸€ä¸ªçˆ¶å®¹å™¨ä¸Šï¼Œè€Œä¸ç”¨æ‹…å¿ƒå½±å“TalkBackæœåŠ¡ã€‚

å‘é€æ— éšœç¢åŠŸèƒ½çš„ç›¸å…³äº‹ä»¶ (Android)
æœ‰æ—¶å€™éœ€è¦åœ¨UIç»„ä»¶ä¸Šä¸»åŠ¨è§¦å‘ä¸€ä¸ªæ— éšœç¢åŠŸèƒ½çš„äº‹ä»¶ï¼ˆæ¯”å¦‚å½“æŸä¸ªè‡ªå®šä¹‰çš„è§†å›¾å‡ºç°åœ¨å±å¹•ä¸Šæˆ–æ˜¯æŸä¸ªè‡ªå®šä¹‰çš„å•é€‰æ¡†è¢«é€‰ä¸­ï¼‰ã€‚ä¸ºæ­¤Native UIManageræ¨¡å—æä¾›äº†ä¸€ä¸ªsendAccessibilityEventæ–¹æ³•ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šviewæ ‡ç­¾å’Œäº‹ä»¶ç±»å‹ã€‚

_onPress: function() {
  this.state.radioButton = this.state.radioButton === â€œradiobutton_checkedâ€ ?
  â€œradiobutton_uncheckedâ€ : â€œradiobutton_checkedâ€;
  if (this.state.radioButton === â€œradiobutton_checkedâ€) {
    RCTUIManager.sendAccessibilityEvent(
      React.findNodeHandle(this),
      RCTUIManager.AccessibilityEventTypes.typeViewClicked);
  }
}

<CustomRadioButton
  accessibleComponentType={this.state.radioButton}
  onPress={this._onPress}/>
åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªè‡ªå®šä¹‰çš„å•é€‰æ¡†ï¼ˆCustomRadioButtonï¼‰ï¼Œå¹¶ä¸”ä½¿å…¶å…·æœ‰äº†å’ŒåŸç”Ÿå•é€‰æ¡†ä¸€æ ·çš„æ— éšœç¢åŠŸèƒ½ã€‚å…·ä½“æ¥è¯´ï¼Œä¹Ÿå°±æ˜¯TalkBackå¯ä»¥æ­£ç¡®åœ°é€šçŸ¥ç”¨æˆ·å½“å‰é€‰é¡¹çš„å˜æ›´äº†

å®šæ—¶å™¨æ˜¯ä¸€ä¸ªåº”ç”¨ä¸­éå¸¸é‡è¦çš„éƒ¨åˆ†ã€‚React Nativeå®ç°äº†å’Œæµè§ˆå™¨ä¸€è‡´çš„å®šæ—¶å™¨Timerã€‚

å®šæ—¶å™¨
setTimeout, clearTimeout
setInterval, clearInterval
setImmediate, clearImmediate
requestAnimationFrame, cancelAnimationFrame
requestAnimationFrame(fn)å’ŒsetTimeout(fn, 0)ä¸åŒï¼Œå‰è€…ä¼šåœ¨æ¯å¸§åˆ·æ–°ä¹‹åæ‰§è¡Œä¸€æ¬¡ï¼Œè€Œåè€…åˆ™ä¼šå°½å¯èƒ½å¿«çš„æ‰§è¡Œï¼ˆåœ¨iPhone5Sä¸Šæœ‰å¯èƒ½æ¯ç§’1000æ¬¡ä»¥ä¸Šï¼‰ã€‚

setImmediateåˆ™ä¼šåœ¨å½“å‰JavaScriptæ‰§è¡Œå—ç»“æŸçš„æ—¶å€™æ‰§è¡Œï¼Œå°±åœ¨å°†è¦å‘é€æ‰¹é‡å“åº”æ•°æ®åˆ°åŸç”Ÿä¹‹å‰ã€‚æ³¨æ„å¦‚æœä½ åœ¨setImmediateçš„å›è°ƒå‡½æ•°ä¸­åˆæ‰§è¡Œäº†setImmediateï¼Œå®ƒä¼šç´§æ¥ç€ç«‹åˆ»æ‰§è¡Œï¼Œè€Œä¸ä¼šåœ¨è°ƒç”¨ä¹‹å‰ç­‰å¾…åŸç”Ÿä»£ç ã€‚

Promiseçš„å®ç°å°±ä½¿ç”¨äº†setImmediateæ¥æ‰§è¡Œå¼‚æ­¥è°ƒç”¨ã€‚

InteractionManager
åŸç”Ÿåº”ç”¨æ„Ÿè§‰å¦‚æ­¤æµç•…çš„ä¸€ä¸ªé‡è¦åŸå› å°±æ˜¯åœ¨äº’åŠ¨å’ŒåŠ¨ç”»çš„è¿‡ç¨‹ä¸­é¿å…ç¹é‡çš„æ“ä½œã€‚åœ¨React Nativeé‡Œï¼Œæˆ‘ä»¬ç›®å‰å—åˆ°é™åˆ¶ï¼Œå› ä¸ºæˆ‘ä»¬åªæœ‰ä¸€ä¸ªJavaScriptæ‰§è¡Œçº¿ç¨‹ã€‚ä¸è¿‡ä½ å¯ä»¥ç”¨InteractionManageræ¥ç¡®ä¿åœ¨æ‰§è¡Œç¹é‡å·¥ä½œä¹‹å‰æ‰€æœ‰çš„äº¤äº’å’ŒåŠ¨ç”»éƒ½å·²ç»å¤„ç†å®Œæ¯•ã€‚

åº”ç”¨å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç æ¥å®‰æ’ä¸€ä¸ªä»»åŠ¡ï¼Œä½¿å…¶åœ¨äº¤äº’ç»“æŸä¹‹åæ‰§è¡Œï¼š

InteractionManager.runAfterInteractions(() => {
   // ...éœ€è¦é•¿æ—¶é—´åŒæ­¥æ‰§è¡Œçš„ä»»åŠ¡...
});
æˆ‘ä»¬æ¥æŠŠå®ƒå’Œä¹‹å‰çš„å‡ ä¸ªä»»åŠ¡å®‰æ’æ–¹æ³•å¯¹æ¯”ä¸€ä¸‹ï¼š

requestAnimationFrame(): ç”¨æ¥æ‰§è¡Œåœ¨ä¸€æ®µæ—¶é—´å†…æ§åˆ¶è§†å›¾åŠ¨ç”»çš„ä»£ç 
setImmediate/setTimeout/setInterval(): åœ¨ç¨åæ‰§è¡Œä»£ç ã€‚æ³¨æ„è¿™æœ‰å¯èƒ½ä¼šå»¶è¿Ÿå½“å‰æ­£åœ¨è¿›è¡Œçš„åŠ¨ç”»ã€‚
runAfterInteractions(): åœ¨ç¨åæ‰§è¡Œä»£ç ï¼Œä¸ä¼šå»¶è¿Ÿå½“å‰è¿›è¡Œçš„åŠ¨ç”»ã€‚
è§¦æ‘¸å¤„ç†ç³»ç»Ÿä¼šæŠŠä¸€ä¸ªæˆ–å¤šä¸ªè¿›è¡Œä¸­çš„è§¦æ‘¸æ“ä½œè®¤å®šä¸º'äº¤äº’'ï¼Œå¹¶ä¸”ä¼šå°†runAfterInteractions()çš„å›è°ƒå‡½æ•°å»¶è¿Ÿæ‰§è¡Œï¼Œç›´åˆ°æ‰€æœ‰çš„è§¦æ‘¸æ“ä½œéƒ½ç»“æŸæˆ–å–æ¶ˆäº†ã€‚

InteractionManagerè¿˜å…è®¸åº”ç”¨æ³¨å†ŒåŠ¨ç”»ï¼Œåœ¨åŠ¨ç”»å¼€å§‹æ—¶åˆ›å»ºä¸€ä¸ªäº¤äº’â€œå¥æŸ„â€ï¼Œç„¶ååœ¨ç»“æŸçš„æ—¶å€™æ¸…é™¤å®ƒã€‚

var handle = InteractionManager.createInteractionHandle();
// æ‰§è¡ŒåŠ¨ç”»... (`runAfterInteractions`ä¸­çš„ä»»åŠ¡ç°åœ¨å¼€å§‹æ’é˜Ÿç­‰å€™)
// åœ¨åŠ¨ç”»å®Œæˆä¹‹å
InteractionManager.clearInteractionHandle(handle);
// åœ¨æ‰€æœ‰å¥æŸ„éƒ½æ¸…é™¤ä¹‹åï¼Œç°åœ¨å¼€å§‹ä¾åºæ‰§è¡Œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡
åŠ¡å¿…åœ¨å¸è½½ç»„ä»¶å‰æ¸…é™¤å®šæ—¶å™¨ï¼
æˆ‘ä»¬å‘ç°å¾ˆå¤šReact Nativeåº”ç”¨å‘ç”Ÿè‡´å‘½é”™è¯¯ï¼ˆé—ªé€€ï¼‰æ˜¯ä¸è®¡æ—¶å™¨æœ‰å…³ã€‚å…·ä½“æ¥è¯´ï¼Œæ˜¯åœ¨æŸä¸ªç»„ä»¶è¢«å¸è½½ï¼ˆunmountï¼‰ä¹‹åï¼Œè®¡æ—¶å™¨å´ä»ç„¶åœ¨è¿è¡Œã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€é“­è®°åœ¨unmountç»„ä»¶æ—¶æ¸…é™¤ï¼ˆclearTimeout/clearIntervalï¼‰æ‰€æœ‰ç”¨åˆ°çš„å®šæ—¶å™¨å³å¯ï¼š

import React,{
  Component
} from 'react';

export default class Hello extends Component {
  componentDidMount() {
    this.timer = setTimeout(
      () => { console.log('æŠŠä¸€ä¸ªå®šæ—¶å™¨çš„å¼•ç”¨æŒ‚åœ¨thisä¸Š'); },
      500
    );
  }
  componentWillUnmount() {
    // è¯·æ³¨æ„Un"m"ountçš„mæ˜¯å°å†™

    // å¦‚æœå­˜åœ¨this.timerï¼Œåˆ™ä½¿ç”¨clearTimeoutæ¸…ç©ºã€‚
    // å¦‚æœä½ ä½¿ç”¨å¤šä¸ªtimerï¼Œé‚£ä¹ˆç”¨å¤šä¸ªå˜é‡ï¼Œæˆ–è€…ç”¨ä¸ªæ•°ç»„æ¥ä¿å­˜å¼•ç”¨ï¼Œç„¶åé€ä¸ªclear
    this.timer && clearTimeout(this.timer);
  }
};

ç›´æ¥æ“ä½œ

æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ç›´æ¥æ”¹åŠ¨ç»„ä»¶å¹¶è§¦å‘å±€éƒ¨çš„åˆ·æ–°ï¼Œä½†ä¸ä½¿ç”¨stateæˆ–æ˜¯propsã€‚è­¬å¦‚åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨Reactåº“ï¼Œæœ‰æ—¶å€™ä¼šéœ€è¦ç›´æ¥ä¿®æ”¹ä¸€ä¸ªDOMèŠ‚ç‚¹ï¼Œè€Œåœ¨æ‰‹æœºAppä¸­æ“ä½œViewæ—¶ä¹Ÿä¼šç¢°åˆ°åŒæ ·çš„æƒ…å†µã€‚åœ¨React Nativeä¸­ï¼ŒsetNativePropså°±æ˜¯ç­‰ä»·äºç›´æ¥æ“ä½œDOMèŠ‚ç‚¹çš„æ–¹æ³•ã€‚

ä»€ä¹ˆæ—¶å€™ä½¿ç”¨setNativePropså‘¢ï¼Ÿåœ¨ï¼ˆä¸å¾—ä¸ï¼‰é¢‘ç¹åˆ·æ–°è€Œåˆé‡åˆ°äº†æ€§èƒ½ç“¶é¢ˆçš„æ—¶å€™ã€‚

ç›´æ¥æ“ä½œç»„ä»¶å¹¶ä¸æ˜¯åº”è¯¥ç»å¸¸ä½¿ç”¨çš„å·¥å…·ã€‚ä¸€èˆ¬æ¥è¯´åªæ˜¯ç”¨æ¥åˆ›å»ºè¿ç»­çš„åŠ¨ç”»ï¼ŒåŒæ—¶é¿å…æ¸²æŸ“ç»„ä»¶ç»“æ„å’ŒåŒæ­¥å¤ªå¤šè§†å›¾å˜åŒ–æ‰€å¸¦æ¥çš„å¤§é‡å¼€é”€ã€‚setNativePropsæ˜¯ä¸€ä¸ªâ€œç®€å•ç²—æš´â€çš„æ–¹æ³•ï¼Œå®ƒç›´æ¥åœ¨åº•å±‚ï¼ˆDOMã€UIViewç­‰ï¼‰è€Œä¸æ˜¯Reactç»„ä»¶ä¸­è®°å½•stateï¼Œè¿™æ ·ä¼šä½¿ä»£ç é€»è¾‘éš¾ä»¥ç†æ¸…ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œè¯·å°½é‡å…ˆå°è¯•ç”¨setStateå’ŒshouldComponentUpdateæ–¹æ³•æ¥è§£å†³é—®é¢˜ã€‚

setNativePropsä¸TouchableOpacity
TouchableOpacityè¿™ä¸ªç»„ä»¶å°±åœ¨å†…éƒ¨ä½¿ç”¨äº†setNativePropsæ–¹æ³•æ¥æ›´æ–°å…¶å­ç»„ä»¶çš„é€æ˜åº¦ï¼š

setOpacityTo: function(value) {
  // Redacted: animation related code
  this.refs[CHILD_REF].setNativeProps({
    opacity: value
  });
},
ç”±æ­¤æˆ‘ä»¬å¯ä»¥å†™å‡ºä¸‹é¢è¿™æ ·çš„ä»£ç ï¼šå­ç»„ä»¶å¯ä»¥å“åº”ç‚¹å‡»äº‹ä»¶ï¼Œæ›´æ”¹è‡ªå·±çš„é€æ˜åº¦ã€‚è€Œå­ç»„ä»¶è‡ªèº«å¹¶ä¸éœ€è¦å¤„ç†è¿™ä»¶äº‹æƒ…ï¼Œä¹Ÿä¸éœ€è¦åœ¨å®ç°ä¸­åšä»»ä½•ä¿®æ”¹ã€‚

<TouchableOpacity onPress={this._handlePress}>
  <View style={styles.button}>
    <Text>Press me!</Text>
  </View>
</TouchableOpacity>
å¦‚æœä¸ä½¿ç”¨setNativePropsè¿™ä¸ªæ–¹æ³•æ¥å®ç°è¿™ä¸€éœ€æ±‚ï¼Œé‚£ä¹ˆä¸€ç§å¯èƒ½çš„åŠæ³•æ˜¯æŠŠé€æ˜å€¼ä¿å­˜åˆ°stateä¸­ï¼Œç„¶ååœ¨onPressäº‹ä»¶è§¦å‘æ—¶æ›´æ–°è¿™ä¸ªå€¼ï¼š

getInitialState() {
  return { myButtonOpacity: 1, }
},

render() {
  return (
    <TouchableOpacity onPress={() => this.setState({myButtonOpacity: 0.5})}
                      onPressOut={() => this.setState({myButtonOpacity: 1})}>
      <View style={[styles.button, {opacity: this.state.myButtonOpacity}]}>
        <Text>Press me!</Text>
      </View>
    </TouchableOpacity>
  )
}
æ¯”èµ·ä¹‹å‰çš„ä¾‹å­ï¼Œè¿™ä¸€åšæ³•ä¼šæ¶ˆè€—å¤§é‡çš„è®¡ç®— â€”â€” æ¯ä¸€æ¬¡é€æ˜å€¼å˜æ›´çš„æ—¶å€™Reactéƒ½è¦é‡æ–°æ¸²æŸ“ç»„ä»¶ç»“æ„ï¼Œå³ä¾¿è§†å›¾çš„å…¶ä»–å±æ€§å’Œå­ç»„ä»¶å¹¶æ²¡æœ‰å˜åŒ–ã€‚ä¸€èˆ¬æ¥è¯´è¿™ä¸€å¼€é”€ä¹Ÿä¸è¶³ä¸ºè™‘ï¼Œä½†å½“æ‰§è¡Œè¿ç»­çš„åŠ¨ç”»ä»¥åŠå“åº”ç”¨æˆ·æ‰‹åŠ¿çš„æ—¶å€™ï¼Œåªæœ‰æ­£ç¡®åœ°ä¼˜åŒ–ç»„ä»¶æ‰èƒ½æé«˜åŠ¨ç”»çš„æµç•…åº¦ã€‚

å¦‚æœä½ çœ‹è¿‡NativeMethodsMixin.jsä¸­çš„setNativePropsæ–¹æ³•çš„å®ç°ï¼Œä½ å°±ä¼šå‘ç°å®ƒå®é™…æ˜¯å¯¹RCTUIManager.updateViewçš„å°è£… â€”â€” è€Œè¿™æ­£æ˜¯é‡æ¸²æŸ“æ‰€è§¦å‘çš„å‡½æ•°è°ƒç”¨ï¼Œå…·ä½“å¯ä»¥å‚çœ‹ReactNativeBaseComponent.jsä¸­çš„receiveComponent.

å¤åˆç»„ä»¶ä¸setNativeProps
å¤åˆç»„ä»¶å¹¶ä¸æ˜¯å•çº¯çš„ç”±ä¸€ä¸ªåŸç”Ÿè§†å›¾æ„æˆï¼Œæ‰€ä»¥ä½ ä¸èƒ½å¯¹å…¶ç›´æ¥ä½¿ç”¨setNativePropsã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š

var MyButton = React.createClass({
  render() {
    return (
      <View>
        <Text>{this.props.label}</Text>
      </View>
    )
  },
});

var App = React.createClass({
  render() {
    return (
      <TouchableOpacity>
        <MyButton label="Press me!" />
      </TouchableOpacity>
    )
  },
});
è¿è¡Œè¿™ä¸ªä¾‹å­ï¼ˆå¯èƒ½éœ€è¦ç§‘å­¦ä¸Šç½‘ï¼‰

è·‘è¿™ä¸ªä¾‹å­ä¼šé©¬ä¸Šçœ‹åˆ°ä¸€è¡ŒæŠ¥é”™ï¼š Touchable child must either be native or forward setNativeProps to a native component. è¿™æ˜¯å› ä¸ºMyButtonå¹¶éç›´æ¥ç”±åŸç”Ÿè§†å›¾æ„æˆï¼Œè€Œæˆ‘ä»¬åªèƒ½ç»™åŸç”Ÿè§†å›¾è®¾ç½®é€æ˜å€¼ã€‚ä½ å¯ä»¥å°è¯•è¿™æ ·å»ç†è§£ï¼šå¦‚æœä½ é€šè¿‡React.createClassæ–¹æ³•è‡ªå®šä¹‰äº†ä¸€ä¸ªç»„ä»¶ï¼Œç›´æ¥ç»™å®ƒè®¾ç½®æ ·å¼propæ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ï¼Œä½ å¾—æŠŠæ ·å¼propså±‚å±‚å‘ä¸‹ä¼ é€’ç»™å­ç»„ä»¶ï¼Œç›´åˆ°å­ç»„ä»¶æ˜¯ä¸€ä¸ªèƒ½å¤Ÿç›´æ¥å®šä¹‰æ ·å¼çš„åŸç”Ÿç»„ä»¶ã€‚åŒç†ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æŠŠsetNativePropsä¼ é€’ç»™ç”±åŸç”Ÿç»„ä»¶å°è£…çš„å­ç»„ä»¶ã€‚

å°†setNativePropsä¼ é€’ç»™å­ç»„ä»¶
å…·ä½“è¦åšçš„å°±æ˜¯åœ¨æˆ‘ä»¬çš„è‡ªå®šä¹‰ç»„ä»¶ä¸­å†å°è£…ä¸€ä¸ªsetNativePropsæ–¹æ³•ï¼Œå…¶å†…å®¹ä¸ºå¯¹åˆé€‚çš„å­ç»„ä»¶è°ƒç”¨çœŸæ­£çš„setNativePropsæ–¹æ³•ï¼Œå¹¶ä¼ é€’è¦è®¾ç½®çš„å‚æ•°ã€‚

var MyButton = React.createClass({
  setNativeProps(nativeProps) {
    this._root.setNativeProps(nativeProps);
  },

  render() {
    return (
      <View ref={component => this._root = component} {...this.props}>
        <Text>{this.props.label}</Text>
      </View>
    )
  },
});
è¿è¡Œè¿™ä¸ªä¾‹å­ï¼ˆå¯èƒ½éœ€è¦ç§‘å­¦ä¸Šç½‘ï¼‰

ç°åœ¨ä½ å¯ä»¥åœ¨TouchableOpacityä¸­åµŒå…¥MyButtonäº†ï¼æœ‰ä¸€ç‚¹éœ€è¦ç‰¹åˆ«è¯´æ˜ï¼šè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†refå›è°ƒè¯­æ³•ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„å­—ç¬¦ä¸²å‹refå¼•ç”¨ã€‚

ä½ å¯èƒ½è¿˜ä¼šæ³¨æ„åˆ°æˆ‘ä»¬åœ¨å‘ä¸‹ä¼ é€’propsæ—¶ä½¿ç”¨äº†{...this.props}è¯­æ³•ï¼ˆè¿™ä¸€ç”¨æ³•çš„è¯´æ˜è¯·å‚è€ƒå¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦ï¼‰ã€‚è¿™æ˜¯å› ä¸ºTouchableOpacityæœ¬èº«å…¶å®ä¹Ÿæ˜¯ä¸ªå¤åˆç»„ä»¶ï¼Œ å®ƒé™¤äº†è¦æ±‚åœ¨å­ç»„ä»¶ä¸Šæ‰§è¡ŒsetNativeProps ä»¥å¤–ï¼Œè¿˜è¦æ±‚å­ç»„ä»¶å¯¹è§¦æ‘¸äº‹ä»¶è¿›è¡Œå¤„ç†ã€‚å› æ­¤ï¼Œå®ƒä¼šä¼ é€’å¤šä¸ªpropsï¼Œå…¶ä¸­åŒ…å«äº†onmoveshouldsetresponder å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°éœ€è¦å›è°ƒç»™TouchableOpacityç»„ä»¶ï¼Œä»¥å®Œæˆè§¦æ‘¸äº‹ä»¶çš„å¤„ç†ã€‚ä¸ä¹‹ç›¸å¯¹çš„æ˜¯TouchableHighlightç»„ä»¶ï¼Œå®ƒæœ¬èº«æ˜¯ç”±åŸç”Ÿè§†å›¾æ„æˆï¼Œå› è€Œåªéœ€è¦æˆ‘ä»¬å®ç°setNativePropsã€‚

é¿å…å’Œrenderæ–¹æ³•çš„å†²çª
å¦‚æœè¦æ›´æ–°ä¸€ä¸ªç”±renderæ–¹æ³•æ¥ç»´æŠ¤çš„å±æ€§ï¼Œåˆ™å¯èƒ½ä¼šç¢°åˆ°ä¸€äº›å‡ºäººæ„æ–™çš„bugã€‚å› ä¸ºæ¯ä¸€æ¬¡ç»„ä»¶é‡æ–°æ¸²æŸ“éƒ½å¯èƒ½å¼•èµ·å±æ€§å˜åŒ–ï¼Œè¿™æ ·ä¸€æ¥ï¼Œä¹‹å‰é€šè¿‡setNativePropsæ‰€è®¾å®šçš„å€¼å°±è¢«å®Œå…¨å¿½ç•¥å’Œè¦†ç›–æ‰äº†ã€‚è¿™ä¸ªä¾‹å­ï¼ˆå¯èƒ½éœ€è¦ç§‘å­¦ä¸Šç½‘ï¼‰ æ¼”ç¤ºäº†ä¸¤è€…å†²çªæ—¶çš„æƒ…å½¢ â€”â€” æ³¨æ„çœ‹ç”±äºsetStateè§¦å‘çš„é‡æ–°æ¸²æŸ“ï¼ˆæ¯250msï¼‰å¯¼è‡´çš„åŠ¨ç”»å¡é¡¿ã€‚

setNativePropsä¸shouldComponentUpdate
é€šè¿‡å·§å¦™è¿ç”¨ shouldComponentUpdateæ–¹æ³•ï¼Œå¯ä»¥é¿å…é‡æ–°æ¸²æŸ“é‚£äº›å®é™…æ²¡æœ‰å˜åŒ–çš„å­ç»„ä»¶æ‰€å¸¦æ¥çš„é¢å¤–å¼€é”€ï¼Œæ­¤æ—¶ä½¿ç”¨setStateçš„æ€§èƒ½å·²ç»å¯ä»¥ä¸setNativePropsç›¸åª²ç¾äº†ã€‚

ç‰¹å®šå¹³å°ä»£ç 

åœ¨åˆ¶ä½œè·¨å¹³å°çš„Appæ—¶ï¼Œå¤šåŠä¼šç¢°åˆ°é’ˆå¯¹ä¸åŒå¹³å°ç¼–å†™ä¸åŒä»£ç çš„éœ€æ±‚ã€‚æœ€ç›´æ¥çš„æ–¹æ¡ˆå°±æ˜¯æŠŠç»„ä»¶æ”¾ç½®åˆ°ä¸åŒçš„æ–‡ä»¶å¤¹ä¸‹ï¼š

/common/components/
/android/components/
/ios/components/
å¦ä¸€ä¸ªé€‰æ‹©æ˜¯æ ¹æ®å¹³å°ä¸åŒåœ¨ç»„ä»¶çš„æ–‡ä»¶å‘½åä¸ŠåŠ ä»¥åŒºåˆ†ï¼Œå¦‚ä¸‹ï¼š

BigButtonIOS.js
BigButtonAndroid.js
ä½†é™¤æ­¤ä»¥å¤–React Nativeè¿˜æä¾›äº†å¦å¤–ä¸¤ç§ç®€å•åŒºåˆ†å¹³å°çš„æ–¹æ¡ˆï¼š

ç‰¹å®šå¹³å°æ‰©å±•å
React Nativeä¼šæ£€æµ‹æŸä¸ªæ–‡ä»¶æ˜¯å¦å…·æœ‰.ios.æˆ–æ˜¯.android.çš„æ‰©å±•åï¼Œç„¶åæ ¹æ®å½“å‰è¿è¡Œçš„å¹³å°åŠ è½½æ­£ç¡®å¯¹åº”çš„æ–‡ä»¶ã€‚

å‡è®¾ä½ çš„é¡¹ç›®ä¸­æœ‰å¦‚ä¸‹ä¸¤ä¸ªæ–‡ä»¶ï¼š

BigButton.ios.js
BigButton.android.js
è¿™æ ·å‘½åç»„ä»¶åä½ å°±å¯ä»¥åœ¨å…¶ä»–ç»„ä»¶ä¸­ç›´æ¥å¼•ç”¨ï¼Œè€Œæ— éœ€å…³å¿ƒå½“å‰è¿è¡Œçš„å¹³å°æ˜¯å“ªä¸ªã€‚

import BigButton from './components/BigButton';
React Nativeä¼šæ ¹æ®è¿è¡Œå¹³å°çš„ä¸åŒå¼•å…¥æ­£ç¡®å¯¹åº”çš„ç»„ä»¶ã€‚

è¿˜æœ‰ä¸ªå®ç”¨çš„æ–¹æ³•æ˜¯Platform.select()ï¼Œå®ƒå¯ä»¥ä»¥Platform.OSä¸ºkeyï¼Œä»ä¼ å…¥çš„å¯¹è±¡ä¸­è¿”å›å¯¹åº”å¹³å°çš„å€¼ï¼Œè§ä¸‹é¢çš„ç¤ºä¾‹ï¼š

import { Platform, StyleSheet } from 'react-native';

var styles = StyleSheet.create({
  container: {
    flex: 1,
    ...Platform.select({
      ios: {
        backgroundColor: 'red',
      },
      android: {
        backgroundColor: 'blue',
      },
    }),
  },
});
ä¸Šé¢çš„ä»£ç ä¼šæ ¹æ®å¹³å°çš„ä¸åŒè¿”å›ä¸åŒçš„containeræ ·å¼â€”â€”iOSä¸ŠèƒŒæ™¯è‰²ä¸ºçº¢è‰²ï¼Œè€Œandroidä¸ºè“è‰²ã€‚

è¿™ä¸€æ–¹æ³•å¯ä»¥æ¥å—ä»»ä½•åˆæ³•ç±»å‹çš„å‚æ•°ï¼Œå› æ­¤ä½ ä¹Ÿå¯ä»¥ç›´æ¥ç”¨å®ƒé’ˆå¯¹ä¸åŒå¹³å°è¿”å›ä¸åŒçš„ç»„ä»¶ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š

var Component = Platform.select({
  ios: () => require('ComponentIOS'),
  android: () => require('ComponentAndroid'),
})();

<Component />;

AccessibilityInfo
æœ‰æ—¶å€™ï¼ŒçŸ¥é“è®¾å¤‡æ˜¯å¦æœ‰å½“å‰æ­£åœ¨è¿è¡Œçš„screenReaderæ˜¯æœ‰ç”¨çš„ã€‚Accessçš„ä¿¡æ¯APIæ˜¯ä¸ºè¿™ä¸ªç›®çš„è€Œè®¾è®¡çš„ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥æŸ¥è¯¢screenReaderçš„å½“å‰çŠ¶æ€ï¼Œå¹¶åœ¨screenReaderçš„çŠ¶æ€æ”¹å˜æ—¶æ³¨å†Œä»¥é€šçŸ¥ã€‚

class ScreenReaderStatusExample extends React.Component {
  state = {
    screenReaderEnabled: false,
  }

  componentDidMount() {
    AccessibilityInfo.addEventListener(
      'change',
      this._handleScreenReaderToggled
    );
    //è¯¢é—®å±å¹•é˜…è¯»å™¨å½“å‰æ˜¯å¦å·²å¯ç”¨ã€‚è¿”å›ä¸€ä¸ªåˆ†è§£ä¸ºå¸ƒå°”çš„å…è¯ºã€‚å½“å¯ç”¨å±å¹•é˜…è¯»å™¨æ—¶ï¼Œç»“æœä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseã€‚

    AccessibilityInfo.fetch().done((isEnabled) => {
      this.setState({
        screenReaderEnabled: isEnabled
      });
    });
  }

  componentWillUnmount() {
    AccessibilityInfo.removeEventListener(
      'change',
      this._handleScreenReaderToggled
    );
  }

  _handleScreenReaderToggled = (isEnabled) => {
    this.setState({
      screenReaderEnabled: isEnabled,
    });
  }

  render() {
    return (
      <View>
        <Text>
          The screen reader is {this.state.screenReaderEnabled ? 'enabled' : 'disabled'}.
        </Text>
      </View>
    );
  }
}

ActivityIndicator
æ˜¾ç¤ºä¸€ä¸ªåœ†å½¢çš„loadingæç¤ºç¬¦å·ã€‚

animating bool
æ˜¯å¦è¦æ˜¾ç¤ºæŒ‡ç¤ºå™¨ï¼Œé»˜è®¤ä¸ºtrueï¼Œè¡¨ç¤ºæ˜¾ç¤ºã€‚

color string
æ»šè½®çš„å‰æ™¯é¢œè‰²ï¼ˆé»˜è®¤ä¸ºç°è‰²ï¼‰ã€‚

hidesWhenStopped bool
åœ¨æ²¡æœ‰åŠ¨ç”»çš„æ—¶å€™ï¼Œæ˜¯å¦è¦éšè—æŒ‡ç¤ºå™¨ï¼ˆé»˜è®¤ä¸ºtrueï¼‰ã€‚

size enum('small', 'large')
æŒ‡ç¤ºå™¨çš„å¤§å°ã€‚smallçš„é«˜åº¦ä¸º20ï¼Œlargeä¸º36ã€‚

'use strict';

const React = require('react');
const ReactNative = require('react-native');
const {
  ActivityIndicator,
  StyleSheet,
  View,
} = ReactNative;
const TimerMixin = require('react-timer-mixin');

const ToggleAnimatingActivityIndicator = React.createClass({
  mixins: [TimerMixin],

  getInitialState() {
    return {
      animating: true,
    };
  },

  setToggleTimeout() {
    this.setTimeout(() => {
      this.setState({animating: !this.state.animating});
      this.setToggleTimeout();
    }, 2000);
  },

  componentDidMount() {
    this.setToggleTimeout();
  },

  render() {
    return (
      <ActivityIndicator
        animating={this.state.animating}
        style={[styles.centering, {height: 80}]}
        size="large"
      />
    );
  }
});

exports.displayName = (undefined: ?string);
exports.framework = 'React';
exports.title = '<ActivityIndicator>';
exports.description = 'Animated loading indicators.';

exports.examples = [
  {
    title: 'Default (small, white)',
    render() {
      return (
        <ActivityIndicator
          style={[styles.centering, styles.gray]}
          color="white"
        />
      );
    }
  },
  {
    title: 'Gray',
    render() {
      return (
        <View>
          <ActivityIndicator
            style={[styles.centering]}
          />
          <ActivityIndicator
            style={[styles.centering, {backgroundColor: '#eeeeee'}]}
          />
        </View>
      );
    }
  },
  {
    title: 'Custom colors',
    render() {
      return (
        <View style={styles.horizontal}>
          <ActivityIndicator color="#0000ff" />
          <ActivityIndicator color="#aa00aa" />
          <ActivityIndicator color="#aa3300" />
          <ActivityIndicator color="#00aa00" />
        </View>
      );
    }
  },
  {
    title: 'Large',
    render() {
      return (
        <ActivityIndicator
          style={[styles.centering, styles.gray]}
          color="white"
          size="large"
        />
      );
    }
  },
  {
    title: 'Large, custom colors',
    render() {
      return (
        <View style={styles.horizontal}>
          <ActivityIndicator
            size="large"
            color="#0000ff"
          />
          <ActivityIndicator
            size="large"
            color="#aa00aa"
          />
          <ActivityIndicator
            size="large"
            color="#aa3300"
          />
          <ActivityIndicator
            size="large"
            color="#00aa00"
          />
        </View>
      );
    }
  },
  {
    title: 'Start/stop',
    render() {
      return <ToggleAnimatingActivityIndicator />;
    }
  },
  {
    title: 'Custom size',
    render() {
      return (
        <ActivityIndicator
          style={[styles.centering, {transform: [{scale: 1.5}]}]}
          size="large"
        />
      );
    }
  },
];

const styles = StyleSheet.create({
  centering: {
    alignItems: 'center',
    justifyContent: 'center',
    padding: 8,
  },
  gray: {
    backgroundColor: '#cccccc',
  },
  horizontal: {
    flexDirection: 'row',
    justifyContent: 'space-around',
    padding: 8,
  },
});

Button
accessibilityLabel string
ç”¨äºç»™æ®‹éšœäººå£«æ˜¾ç¤ºçš„æ–‡æœ¬ï¼ˆæ¯”å¦‚è¯»å±å™¨è½¯ä»¶å¯èƒ½ä¼šè¯»å–è¿™ä¸€å†…å®¹ï¼‰

color color
æ–‡æœ¬çš„é¢œè‰²(iOS)ï¼Œæˆ–æ˜¯æŒ‰é’®çš„èƒŒæ™¯è‰²(Android)

disabled bool
è®¾ç½®ä¸ºtrueæ—¶æ­¤æŒ‰é’®å°†ä¸å¯ç‚¹å‡»

onPress function
ç”¨æˆ·ç‚¹å‡»æ­¤æŒ‰é’®æ—¶æ‰€è°ƒç”¨çš„å¤„ç†å‡½æ•°

title string
æŒ‰é’®å†…æ˜¾ç¤ºçš„æ–‡æœ¬

use strict';

const React = require('react');
const ReactNative = require('react-native');
const {
  Alert,
  Button,
  View,
} = ReactNative;

const onButtonPress = () => {
  Alert.alert('Button has been pressed!');
};

exports.displayName = 'ButtonExample';
exports.framework = 'React';
exports.title = '<Button>';
exports.description = 'Simple React Native button component.';

exports.examples = [
  {
    title: 'Simple Button',
    description: 'The title and onPress handler are required. It is ' +
      'recommended to set accessibilityLabel to help make your app usable by ' +
      'everyone.',
    render: function() {
      return (
        <Button
          onPress={onButtonPress}
          title="Press Me"
          accessibilityLabel="See an informative alert"
        />
      );
    },
  },
  {
    title: 'Adjusted color',
    description: 'Adjusts the color in a way that looks standard on each ' +
      'platform. On iOS, the color prop controls the color of the text. On ' +
      'Android, the color adjusts the background color of the button.',
    render: function() {
      return (
        <Button
          onPress={onButtonPress}
          title="Press Purple"
          color="#841584"
          accessibilityLabel="Learn more about purple"
        />
      );
    },
  },
  {
    title: 'Fit to text layout',
    description: 'This layout strategy lets the title define the width of ' +
      'the button',
    render: function() {
      return (
        <View style={{flexDirection: 'row', justifyContent: 'space-between'}}>
          <Button
            onPress={onButtonPress}
            title="This looks great!"
            accessibilityLabel="This sounds great!"
          />
          <Button
            onPress={onButtonPress}
            title="Ok!"
            color="#841584"
            accessibilityLabel="Ok, Great!"
          />
        </View>
      );
    },
  },
  {
    title: 'Disabled Button',
    description: 'All interactions for the component are disabled.',
    render: function() {
      return (
        <Button
          disabled
          onPress={onButtonPress}
          title="I Am Disabled"
          accessibilityLabel="See an informative alert"
        />
      );
    },
  },
];

checkbox

disabled?: bool
å¦‚æœä¸ºtrueï¼Œè¿™ä¸ªç»„ä»¶ä¸èƒ½è¿›è¡Œäº¤äº’,é»˜è®¤ä¸ºfalse

onChange?: function
Used in case the props change removes the component.

onValueChange?: function
å½“å€¼æ”¹å˜çš„æ—¶å€™è°ƒç”¨æ­¤å›è°ƒå‡½æ•°ï¼Œå‚æ•°ä¸ºæ–°çš„å€¼ã€‚

testID?: string
ç”¨æ¥åœ¨ç«¯åˆ°ç«¯æµ‹è¯•ä¸­å®šä½æ­¤è§†å›¾ã€‚

value?: bool
è¡¨ç¤ºCheckBoxæ˜¯å¦æ‰“å¼€ã€‚é»˜è®¤ä¸ºfalseï¼ˆå…³é—­çŠ¶æ€ï¼‰ã€‚

DrawerLayoutAndroid
render: function() {
  var navigationView = (
    <View style={{flex: 1, backgroundColor: '#fff'}}>
      <Text style={{margin: 10, fontSize: 15, textAlign: 'left'}}>I'm in the Drawer!</Text>
    </View>
  );
  return (
    <DrawerLayoutAndroid
      drawerWidth={300}
      drawerPosition={DrawerLayoutAndroid.positions.Left}
      renderNavigationView={() => navigationView}>
      <View style={{flex: 1, alignItems: 'center'}}>
        <Text style={{margin: 10, fontSize: 15, textAlign: 'right'}}>Hello</Text>
        <Text style={{margin: 10, fontSize: 15, textAlign: 'right'}}>World!</Text>
      </View>
    </DrawerLayoutAndroid>
  );
},

drawerLockMode enum('unlocked', 'locked-closed', 'locked-open')
è®¾ç½®æŠ½å±‰çš„é”å®šæ¨¡å¼ã€‚æœ‰ä¸‰ç§çŠ¶æ€ï¼š

unlocked (é»˜è®¤å€¼)ï¼Œæ„å‘³ç€æ­¤æ—¶æŠ½å±‰å¯ä»¥å“åº”æ‰“å¼€å’Œå…³é—­çš„æ‰‹åŠ¿æ“ä½œã€‚
locked-closedï¼Œæ„å‘³ç€æ­¤æ—¶æŠ½å±‰å°†ä¿æŒå…³é—­ï¼Œä¸å¯ç”¨æ‰‹åŠ¿æ‰“å¼€ã€‚
locked-openï¼Œæ„å‘³ç€æ­¤æ—¶æŠ½å±‰å°†ä¿æŒæ‰“å¼€ï¼Œä¸å¯ç”¨æ‰‹åŠ¿å…³é—­ã€‚
æ— è®ºæŠ½å±‰å¤„äºé‚£ç§çŠ¶æ€ï¼Œéƒ½ä»ç„¶å¯ä»¥è°ƒç”¨openDrawer/closeDrawerè¿™ä¸¤ä¸ªæ–¹æ³•æ‰“å¼€å’Œå…³é—­ã€‚

drawerPosition enum(DrawerConsts.DrawerPosition.Left, DrawerConsts.DrawerPosition.Right)
æŒ‡å®šæŠ½å±‰å¯ä»¥ä»å±å¹•çš„å“ªä¸€è¾¹æ»‘å…¥ã€‚

drawerWidth number
æŒ‡å®šæŠ½å±‰çš„å®½åº¦ï¼Œä¹Ÿå°±æ˜¯ä»å±å¹•è¾¹ç¼˜æ‹–è¿›çš„è§†å›¾çš„å®½åº¦ã€‚

keyboardDismissMode enum('none', "on-drag")
æŒ‡å®šåœ¨æ‹–æ‹½çš„è¿‡ç¨‹ä¸­æ˜¯å¦è¦éšè—è½¯é”®ç›˜ã€‚

none (é»˜è®¤å€¼)ï¼Œæ‹–æ‹½ä¸ä¼šéšè—è½¯é”®ç›˜ã€‚

on-drag å½“æ‹–æ‹½å¼€å§‹çš„æ—¶å€™éšè—è½¯é”®ç›˜ã€‚

onDrawerClose function
æ¯å½“å¯¼èˆªè§†å›¾ï¼ˆæŠ½å±‰ï¼‰è¢«å…³é—­ä¹‹åè°ƒç”¨æ­¤å›è°ƒå‡½æ•°ã€‚

onDrawerOpen function
æ¯å½“å¯¼èˆªè§†å›¾ï¼ˆæŠ½å±‰ï¼‰è¢«æ‰“å¼€ä¹‹åè°ƒç”¨æ­¤å›è°ƒå‡½æ•°ã€‚

onDrawerSlide function
æ¯å½“å¯¼èˆªè§†å›¾ï¼ˆæŠ½å±‰ï¼‰äº§ç”Ÿäº¤äº’çš„æ—¶å€™è°ƒç”¨æ­¤å›è°ƒå‡½æ•°ã€‚

onDrawerStateChanged function
æ¯å½“æŠ½å±‰çš„çŠ¶æ€å˜åŒ–æ—¶è°ƒç”¨æ­¤å›è°ƒå‡½æ•°ã€‚æŠ½å±‰å¯ä»¥æœ‰3ç§çŠ¶æ€ï¼š

idleï¼ˆç©ºé—²ï¼‰ï¼Œè¡¨ç¤ºç°åœ¨å¯¼èˆªæ¡ä¸Šæ²¡æœ‰ä»»ä½•æ­£åœ¨è¿›è¡Œçš„äº¤äº’ã€‚

draggingï¼ˆæ‹–æ‹½ä¸­ï¼‰ï¼Œè¡¨ç¤ºç”¨æˆ·æ­£åœ¨ä¸å¯¼èˆªæ¡è¿›è¡Œäº¤äº’ã€‚

settlingï¼ˆåœé ä¸­ï¼‰ï¼Œè¡¨ç¤ºç”¨æˆ·åˆšåˆšç»“æŸä¸å¯¼èˆªæ¡çš„äº¤äº’ï¼Œå¯¼èˆªæ¡æ­£åœ¨ç»“æŸæ‰“å¼€æˆ–è€…å…³é—­çš„åŠ¨ç”»ã€‚

renderNavigationView function
æ­¤æ–¹æ³•ç”¨äºæ¸²æŸ“ä¸€ä¸ªå¯ä»¥ä»å±å¹•ä¸€è¾¹æ‹–å…¥çš„å¯¼èˆªè§†å›¾ã€‚

flatList

é«˜æ€§èƒ½çš„ç®€å•åˆ—è¡¨ç»„ä»¶ï¼Œæ”¯æŒä¸‹é¢è¿™äº›å¸¸ç”¨çš„åŠŸèƒ½ï¼š

å®Œå…¨è·¨å¹³å°ã€‚
æ”¯æŒæ°´å¹³å¸ƒå±€æ¨¡å¼ã€‚
è¡Œç»„ä»¶æ˜¾ç¤ºæˆ–éšè—æ—¶å¯é…ç½®å›è°ƒäº‹ä»¶ã€‚
æ”¯æŒå•ç‹¬çš„å¤´éƒ¨ç»„ä»¶ã€‚
æ”¯æŒå•ç‹¬çš„å°¾éƒ¨ç»„ä»¶ã€‚
æ”¯æŒè‡ªå®šä¹‰è¡Œé—´åˆ†éš”çº¿ã€‚
æ”¯æŒä¸‹æ‹‰åˆ·æ–°ã€‚
æ”¯æŒä¸Šæ‹‰åŠ è½½ã€‚
æ”¯æŒè·³è½¬åˆ°æŒ‡å®šè¡Œï¼ˆScrollToIndexï¼‰ã€‚
å¦‚æœéœ€è¦åˆ†ç»„/ç±»/åŒºï¼ˆsectionï¼‰ï¼Œè¯·ä½¿ç”¨<SectionList>ã€‚

ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼š

<FlatList
  data={[{key: 'a'}, {key: 'b'}]}
  renderItem={({item}) => <Text>{item.key}</Text>}
/>
ä¸‹é¢æ˜¯ä¸€ä¸ªè¾ƒå¤æ‚çš„ä¾‹å­ï¼Œå…¶ä¸­æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨PureComponentæ¥è¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½å’Œå‡å°‘bugäº§ç”Ÿçš„å¯èƒ½ï¼ˆä»¥ä¸‹è¿™æ®µæ–‡å­—éœ€è¦ä½ æ·±åˆ»ç†è§£shouldComponentUpdateçš„æœºåˆ¶ï¼Œä»¥åŠComponentå’ŒPureComponentçš„ä¸åŒï¼Œæ‰€ä»¥å¦‚æœä¸äº†è§£å°±å…ˆè·³è¿‡å§ï¼‰ã€‚

å¯¹äºMyListItemç»„ä»¶æ¥è¯´ï¼Œå…¶onPressItemå±æ€§ä½¿ç”¨ç®­å¤´å‡½æ•°è€Œébindçš„æ–¹å¼è¿›è¡Œç»‘å®šï¼Œä½¿å…¶ä¸ä¼šåœ¨æ¯æ¬¡åˆ—è¡¨é‡æ–°renderæ—¶ç”Ÿæˆä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œä»è€Œä¿è¯äº†propsçš„ä¸å˜æ€§ï¼ˆå½“ç„¶å‰ææ˜¯ idã€selectedå’Œtitleä¹Ÿæ²¡å˜ï¼‰ï¼Œä¸ä¼šè§¦å‘è‡ªèº«æ— è°“çš„é‡æ–°renderã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä½ æ˜¯ç”¨bindæ¥ç»‘å®šonPressItemï¼Œæ¯æ¬¡éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå¯¼è‡´propsåœ¨===æ¯”è¾ƒæ—¶è¿”å›falseï¼Œä»è€Œè§¦å‘è‡ªèº«çš„ä¸€æ¬¡ä¸å¿…è¦çš„é‡æ–°renderã€‚
ç»™FlatListæŒ‡å®šextraData={this.state}å±æ€§ï¼Œæ˜¯ä¸ºäº†ä¿è¯state.selectedå˜åŒ–æ—¶ï¼Œèƒ½å¤Ÿæ­£ç¡®è§¦å‘FlatListçš„æ›´æ–°ã€‚å¦‚æœä¸æŒ‡å®šæ­¤å±æ€§ï¼Œåˆ™FlatListä¸ä¼šè§¦å‘æ›´æ–°ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªPureComponentï¼Œå…¶propsåœ¨===æ¯”è¾ƒä¸­æ²¡æœ‰å˜åŒ–åˆ™ä¸ä¼šè§¦å‘æ›´æ–°ã€‚
keyExtractorå±æ€§æŒ‡å®šä½¿ç”¨idä½œä¸ºåˆ—è¡¨æ¯ä¸€é¡¹çš„keyã€‚
class MyListItem extends React.PureComponent {
  _onPress = () => {
    this.props.onPressItem(this.props.id);
  };

  render() {
    return (
      <SomeOtherWidget
        {...this.props}
        onPress={this._onPress}
      />
    )
  }
}

class MyList extends React.PureComponent {
  state = {selected: (new Map(): Map<string, boolean>)};

  _keyExtractor = (item, index) => item.id;

  _onPressItem = (id: string) => {
    // updater functions are preferred for transactional updates
    this.setState((state) => {
      // copy the map rather than modifying state.
      const selected = new Map(state.selected);
      selected.set(id, !selected.get(id)); // toggle
      return {selected};
    });
  };

  _renderItem = ({item}) => (
    <MyListItem
      id={item.id}
      onPressItem={this._onPressItem}
      selected={!!this.state.selected.get(item.id)}
      title={item.title}
    />
  );

  render() {
    return (
      <FlatList
        data={this.props.data}
        extraData={this.state}
        keyExtractor={this._keyExtractor}
        renderItem={this._renderItem}
      />
    );
  }
}
æœ¬ç»„ä»¶å®è´¨æ˜¯åŸºäº<VirtualizedList>ç»„ä»¶çš„å°è£…ï¼Œå› æ­¤ä¹Ÿæœ‰ä¸‹é¢è¿™äº›éœ€è¦æ³¨æ„çš„äº‹é¡¹ï¼š

å½“æŸè¡Œæ»‘å‡ºæ¸²æŸ“åŒºåŸŸä¹‹å¤–åï¼Œå…¶å†…éƒ¨çŠ¶æ€å°†ä¸ä¼šä¿ç•™ã€‚è¯·ç¡®ä¿ä½ åœ¨è¡Œç»„ä»¶ä»¥å¤–çš„åœ°æ–¹ä¿ç•™äº†æ•°æ®ã€‚
ä¸ºäº†ä¼˜åŒ–å†…å­˜å ç”¨åŒæ—¶ä¿æŒæ»‘åŠ¨çš„æµç•…ï¼Œåˆ—è¡¨å†…å®¹ä¼šåœ¨å±å¹•å¤–å¼‚æ­¥ç»˜åˆ¶ã€‚è¿™æ„å‘³ç€å¦‚æœç”¨æˆ·æ»‘åŠ¨çš„é€Ÿåº¦è¶…è¿‡æ¸²æŸ“çš„é€Ÿåº¦ï¼Œåˆ™ä¼šå…ˆçœ‹åˆ°ç©ºç™½çš„å†…å®¹ã€‚è¿™æ˜¯ä¸ºäº†ä¼˜åŒ–ä¸å¾—ä¸ä½œå‡ºçš„å¦¥åï¼Œè€Œæˆ‘ä»¬ä¹Ÿåœ¨è®¾æ³•æŒç»­æ”¹è¿›ã€‚
æœ¬ç»„ä»¶ç»§æ‰¿è‡ªPureComponentè€Œéé€šå¸¸çš„Componentï¼Œè¿™æ„å‘³ç€å¦‚æœå…¶propsåœ¨æµ…æ¯”è¾ƒä¸­æ˜¯ç›¸ç­‰çš„ï¼Œåˆ™ä¸ä¼šé‡æ–°æ¸²æŸ“ã€‚æ‰€ä»¥è¯·å…ˆæ£€æŸ¥ä½ çš„renderItemå‡½æ•°æ‰€ä¾èµ–çš„propsæ•°æ®ï¼ˆåŒ…æ‹¬dataå±æ€§ä»¥åŠå¯èƒ½ç”¨åˆ°çš„çˆ¶ç»„ä»¶çš„stateï¼‰ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼ˆObjectæˆ–è€…æ•°ç»„éƒ½æ˜¯å¼•ç”¨ç±»å‹ï¼‰ï¼Œåˆ™éœ€è¦å…ˆä¿®æ”¹å…¶å¼•ç”¨åœ°å€ï¼ˆæ¯”å¦‚å…ˆå¤åˆ¶åˆ°ä¸€ä¸ªæ–°çš„Objectæˆ–è€…æ•°ç»„ä¸­ï¼‰ï¼Œç„¶åå†ä¿®æ”¹å…¶å€¼ï¼Œå¦åˆ™ç•Œé¢å¾ˆå¯èƒ½ä¸ä¼šåˆ·æ–°ã€‚ï¼ˆè¯‘æ³¨ï¼šè¿™ä¸€æ®µä¸äº†è§£çš„æœ‹å‹å»ºè®®å…ˆå­¦ä¹ ä¸‹jsä¸­çš„åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹ã€‚ï¼‰
é»˜è®¤æƒ…å†µä¸‹æ¯è¡Œéƒ½éœ€è¦æä¾›ä¸€ä¸ªä¸é‡å¤çš„keyå±æ€§ã€‚ä½ ä¹Ÿå¯ä»¥æä¾›ä¸€ä¸ªkeyExtractorå‡½æ•°æ¥ç”Ÿæˆkeyã€‚
æ³¨æ„ï¼šremoveClippedSubviewså±æ€§ç›®å‰æ˜¯ä¸å¿…è¦çš„ï¼Œè€Œä¸”å¯èƒ½ä¼šå¼•èµ·é—®é¢˜ã€‚å¦‚æœä½ åœ¨æŸäº›åœºæ™¯ç¢°åˆ°å†…å®¹ä¸æ¸²æŸ“çš„æƒ…å†µï¼ˆæ¯”å¦‚ä½¿ç”¨LayoutAnimationæ—¶ï¼‰ï¼Œå°è¯•è®¾ç½®removeClippedSubviews={false}ã€‚æˆ‘ä»¬å¯èƒ½ä¼šåœ¨å°†æ¥çš„ç‰ˆæœ¬ä¸­ä¿®æ”¹æ­¤å±æ€§çš„é»˜è®¤å€¼ã€‚

å±æ€§
ItemSeparatorComponent?: ?ReactClass<any>
è¡Œä¸è¡Œä¹‹é—´çš„åˆ†éš”çº¿ç»„ä»¶ã€‚ä¸ä¼šå‡ºç°åœ¨ç¬¬ä¸€è¡Œä¹‹å‰å’Œæœ€åä¸€è¡Œä¹‹åã€‚

ListEmptyComponent?: ?ReactClass<any> | React.Element<any>
åˆ—è¡¨ä¸ºç©ºæ—¶æ¸²æŸ“è¯¥ç»„ä»¶ã€‚å¯ä»¥æ˜¯React Component, ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªrenderå‡½æ•°ï¼Œ æˆ–è€…æ¸²æŸ“å¥½çš„elementã€‚

ListFooterComponent?: ?ReactClass<any>
å°¾éƒ¨ç»„ä»¶

ListHeaderComponent?: ?ReactClass<any>
å¤´éƒ¨ç»„ä»¶

columnWrapperStyle?: StyleObj
å¦‚æœè®¾ç½®äº†å¤šåˆ—å¸ƒå±€ï¼ˆå³å°†numColumnså€¼è®¾ä¸ºå¤§äº1çš„æ•´æ•°ï¼‰ï¼Œåˆ™å¯ä»¥é¢å¤–æŒ‡å®šæ­¤æ ·å¼ä½œç”¨åœ¨æ¯è¡Œå®¹å™¨ä¸Šã€‚

data: ?Array<ItemT>
ä¸ºäº†ç®€åŒ–èµ·è§ï¼Œdataå±æ€§ç›®å‰åªæ”¯æŒæ™®é€šæ•°ç»„ã€‚å¦‚æœéœ€è¦ä½¿ç”¨å…¶ä»–ç‰¹æ®Šæ•°æ®ç»“æ„ï¼Œä¾‹å¦‚immutableæ•°ç»„ï¼Œè¯·ç›´æ¥ä½¿ç”¨æ›´åº•å±‚çš„VirtualizedListç»„ä»¶ã€‚

extraData?: any
å¦‚æœæœ‰é™¤dataä»¥å¤–çš„æ•°æ®ç”¨åœ¨åˆ—è¡¨ä¸­ï¼ˆä¸è®ºæ˜¯ç”¨åœ¨renderItemè¿˜æ˜¯Headeræˆ–è€…Footerä¸­ï¼‰ï¼Œè¯·åœ¨æ­¤å±æ€§ä¸­æŒ‡å®šã€‚åŒæ—¶æ­¤æ•°æ®åœ¨ä¿®æ”¹æ—¶ä¹Ÿéœ€è¦å…ˆä¿®æ”¹å…¶å¼•ç”¨åœ°å€ï¼ˆæ¯”å¦‚å…ˆå¤åˆ¶åˆ°ä¸€ä¸ªæ–°çš„Objectæˆ–è€…æ•°ç»„ä¸­ï¼‰ï¼Œç„¶åå†ä¿®æ”¹å…¶å€¼ï¼Œå¦åˆ™ç•Œé¢å¾ˆå¯èƒ½ä¸ä¼šåˆ·æ–°ã€‚

getItem?:
getItemCount?:
getItemLayout?: (data: ?Array<ItemT>, index: number) =>
  {length: number, offset: number, index: number}
getItemLayoutæ˜¯ä¸€ä¸ªå¯é€‰çš„ä¼˜åŒ–ï¼Œç”¨äºé¿å…åŠ¨æ€æµ‹é‡å†…å®¹å°ºå¯¸çš„å¼€é”€ï¼Œä¸è¿‡å‰ææ˜¯ä½ å¯ä»¥æå‰çŸ¥é“å†…å®¹çš„é«˜åº¦ã€‚å¦‚æœä½ çš„è¡Œé«˜æ˜¯å›ºå®šçš„ï¼ŒgetItemLayoutç”¨èµ·æ¥å°±æ—¢é«˜æ•ˆåˆç®€å•ï¼Œç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼š

getItemLayout={(data, index) => ( {length: è¡Œé«˜, offset: è¡Œé«˜ * index, index} )}
æ³¨æ„å¦‚æœä½ æŒ‡å®šäº†SeparatorComponentï¼Œè¯·æŠŠåˆ†éš”çº¿çš„å°ºå¯¸ä¹Ÿè€ƒè™‘åˆ°offsetçš„è®¡ç®—ä¹‹ä¸­ã€‚

horizontal?: ?boolean
è®¾ç½®ä¸ºtrueåˆ™å˜ä¸ºæ°´å¹³å¸ƒå±€æ¨¡å¼ã€‚

initialNumToRender: number
æŒ‡å®šä¸€å¼€å§‹æ¸²æŸ“çš„å…ƒç´ æ•°é‡ï¼Œæœ€å¥½åˆšåˆšå¤Ÿå¡«æ»¡ä¸€ä¸ªå±å¹•ï¼Œè¿™æ ·ä¿è¯äº†ç”¨æœ€çŸ­çš„æ—¶é—´ç»™ç”¨æˆ·å‘ˆç°å¯è§çš„å†…å®¹ã€‚æ³¨æ„è¿™ç¬¬ä¸€æ‰¹æ¬¡æ¸²æŸ“çš„å…ƒç´ ä¸ä¼šåœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­è¢«å¸è½½ï¼Œè¿™æ ·æ˜¯ä¸ºäº†ä¿è¯ç”¨æˆ·æ‰§è¡Œè¿”å›é¡¶éƒ¨çš„æ“ä½œæ—¶ï¼Œä¸éœ€è¦é‡æ–°æ¸²æŸ“é¦–æ‰¹å…ƒç´ ã€‚


initialScrollIndex?: ?number
å¼€å§‹æ—¶å±å¹•é¡¶ç«¯çš„å…ƒç´ æ˜¯åˆ—è¡¨ä¸­çš„ç¬¬ initialScrollIndex ä¸ªå…ƒç´ , è€Œä¸æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚è®¾ç½®è¿™ä¸ªå±æ€§ä¼šå…³é—­å¯¹â€œæ»šåŠ¨åˆ°é¡¶ç«¯â€è¿™ä¸ªåŠ¨ä½œçš„ä¼˜åŒ–ï¼ˆå‚è§VirtualizedList çš„ initialNumToRender å±æ€§)ã€‚ä½äº initialScrollIndex ä½ç½®çš„å…ƒç´ æ€»æ˜¯ä¼šè¢«ç«‹åˆ»æ¸²æŸ“ã€‚éœ€è¦å…ˆè®¾ç½® getItemLayout å±æ€§ã€‚

inverted?: ?boolean
ç¿»è½¬æ»šåŠ¨æ–¹å‘ã€‚å®è´¨æ˜¯å°†scaleå˜æ¢è®¾ç½®ä¸º-1ã€‚

keyExtractor: (item: ItemT, index: number) => string
æ­¤å‡½æ•°ç”¨äºä¸ºç»™å®šçš„itemç”Ÿæˆä¸€ä¸ªä¸é‡å¤çš„keyã€‚Keyçš„ä½œç”¨æ˜¯ä½¿Reactèƒ½å¤ŸåŒºåˆ†åŒç±»å…ƒç´ çš„ä¸åŒä¸ªä½“ï¼Œä»¥ä¾¿åœ¨åˆ·æ–°æ—¶èƒ½å¤Ÿç¡®å®šå…¶å˜åŒ–çš„ä½ç½®ï¼Œå‡å°‘é‡æ–°æ¸²æŸ“çš„å¼€é”€ã€‚è‹¥ä¸æŒ‡å®šæ­¤å‡½æ•°ï¼Œåˆ™é»˜è®¤æŠ½å–item.keyä½œä¸ºkeyå€¼ã€‚è‹¥item.keyä¹Ÿä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨æ•°ç»„ä¸‹æ ‡ã€‚

legacyImplementation?:  ?boolean

è®¾ç½®ä¸ºtrueåˆ™ä½¿ç”¨æ—§çš„ListViewçš„å®ç°ã€‚

numColumns: number
å¤šåˆ—å¸ƒå±€åªèƒ½åœ¨éæ°´å¹³æ¨¡å¼ä¸‹ä½¿ç”¨ï¼Œå³å¿…é¡»æ˜¯horizontal={false}ã€‚æ­¤æ—¶ç»„ä»¶å†…å…ƒç´ ä¼šä»å·¦åˆ°å³ä»ä¸Šåˆ°ä¸‹æŒ‰Zå­—å½¢æ’åˆ—ï¼Œç±»ä¼¼å¯ç”¨äº†flexWrapçš„å¸ƒå±€ã€‚ç»„ä»¶å†…å…ƒç´ å¿…é¡»æ˜¯ç­‰é«˜çš„â€”â€”æš‚æ—¶è¿˜æ— æ³•æ”¯æŒç€‘å¸ƒæµå¸ƒå±€ã€‚

onEndReached?: ?(info: {distanceFromEnd: number}) => void
å½“åˆ—è¡¨è¢«æ»šåŠ¨åˆ°è·ç¦»å†…å®¹æœ€åº•éƒ¨ä¸è¶³onEndReachedThresholdçš„è·ç¦»æ—¶è°ƒç”¨ã€‚

onEndReachedThreshold?: ?number
å†³å®šå½“è·ç¦»å†…å®¹æœ€åº•éƒ¨è¿˜æœ‰å¤šè¿œæ—¶è§¦å‘onEndReachedå›è°ƒã€‚æ³¨æ„æ­¤å‚æ•°æ˜¯ä¸€ä¸ªæ¯”å€¼è€Œéåƒç´ å•ä½ã€‚æ¯”å¦‚ï¼Œ0.5è¡¨ç¤ºè·ç¦»å†…å®¹æœ€åº•éƒ¨çš„è·ç¦»ä¸ºå½“å‰åˆ—è¡¨å¯è§é•¿åº¦çš„ä¸€åŠæ—¶è§¦å‘ã€‚

onRefresh?: ?() => void
å¦‚æœè®¾ç½®äº†æ­¤é€‰é¡¹ï¼Œåˆ™ä¼šåœ¨åˆ—è¡¨å¤´éƒ¨æ·»åŠ ä¸€ä¸ªæ ‡å‡†çš„RefreshControlæ§ä»¶ï¼Œä»¥ä¾¿å®ç°â€œä¸‹æ‹‰åˆ·æ–°â€çš„åŠŸèƒ½ã€‚åŒæ—¶ä½ éœ€è¦æ­£ç¡®è®¾ç½®refreshingå±æ€§ã€‚

onViewableItemsChanged?:  ?(info: {viewableItems: Array<ViewToken>, changed: Array<ViewToken>}) => void
åœ¨å¯è§è¡Œå…ƒç´ å˜åŒ–æ—¶è°ƒç”¨ã€‚å¯è§èŒƒå›´å’Œå˜åŒ–é¢‘ç‡ç­‰å‚æ•°çš„é…ç½®è¯·è®¾ç½®viewabilityconfigå±æ€§

refreshing?: ?boolean
åœ¨ç­‰å¾…åŠ è½½æ–°æ•°æ®æ—¶å°†æ­¤å±æ€§è®¾ä¸ºtrueï¼Œåˆ—è¡¨å°±ä¼šæ˜¾ç¤ºå‡ºä¸€ä¸ªæ­£åœ¨åŠ è½½çš„ç¬¦å·ã€‚

renderItem: (info: {item: ItemT, index: number}) => ?React.Element<any>
æ ¹æ®è¡Œæ•°æ®dataæ¸²æŸ“æ¯ä¸€è¡Œçš„ç»„ä»¶ã€‚å…¸å‹ç”¨æ³•ï¼š

<FlatList
  ItemSeparatorComponent={Platform.OS !== 'android' && ({highlighted}) => (<View style={[style.separator, highlighted && {marginLeft: 0}]} /> )}
  data={[{title: 'Title Text', key: 'item1'}]}
  renderItem={({item, separators}) => (
    <TouchableHighlight
      onPress={() => this._onPress(item)}
      onShowUnderlay={separators.highlight}
      onHideUnderlay={separators.unhighlight}>
      <View style={{backgroundColor: 'white'}}>
        <Text>{item.title}}</Text>
      </View>
    </TouchableHighlight>
  )}
/>
å¦‚æœéœ€è¦çš„è¯ï¼Œä½ å¯ä»¥è®¾ç½® index å±æ€§çš„å€¼ã€‚åŒæ ·ï¼Œå¦‚æœ highlight å’Œ unhightlightï¼ˆè¿™ä¸¤ä¸ªæ–¹æ³•è®¾ç½® highlighted: boolean å±æ€§ï¼‰ ä¸èƒ½æ»¡è¶³ä½ çš„è¦æ±‚çš„è¯ï¼Œä½ ä¹Ÿå¯ä»¥æä¾›ä¸€ä¸ªæ›´åŠ é€šç”¨çš„ separators.updateProps æ–¹æ³•ã€‚é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œä½ å¯ä»¥è®¾ç½®ä¸€äº›å±æ€§æ¥æ”¹å˜åˆ—è¡¨çš„é¡¶éƒ¨åˆ†éš”ç¬¦å’Œåº•éƒ¨åˆ†éš”ç¬¦çš„æ ·å¼ã€‚

viewabilityConfig?: ViewabilityConfig
è¯·å‚è€ƒViewabilityHelperçš„æºç æ¥äº†è§£å…·ä½“çš„é…ç½®ã€‚

progressViewOffset?: number
å½“éœ€è¦åœ¨æŒ‡å®šçš„åç§»å†…æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨çš„æ—¶å€™ï¼Œå°±å¯ä»¥è®¾ç½®è¿™ä¸ªå€¼ã€‚

æ–¹æ³•
scrollToEnd(params?: object)
æ»šåŠ¨åˆ°åº•éƒ¨ã€‚å¦‚æœä¸è®¾ç½®getItemLayoutå±æ€§çš„è¯ï¼Œå¯èƒ½ä¼šæ¯”è¾ƒå¡ã€‚

scrollToIndex(params: object)
å°†ä½äºæŒ‡å®šä½ç½®çš„å…ƒç´ æ»šåŠ¨åˆ°å¯è§†åŒºçš„æŒ‡å®šä½ç½®ï¼Œå½“ viewPosition ä¸º 0 æ—¶å°†å®ƒæ»šåŠ¨åˆ°å±å¹•é¡¶éƒ¨ï¼Œä¸º 1 æ—¶å°†å®ƒæ»šåŠ¨åˆ°å±å¹•åº•éƒ¨ï¼Œä¸º 0.5 æ—¶å°†å®ƒæ»šåŠ¨åˆ°å±å¹•ä¸­å¤®ã€‚

å¦‚æœä¸è®¾ç½®getItemLayoutå±æ€§çš„è¯ï¼Œæ— æ³•è·³è½¬åˆ°å½“å‰å¯è§†åŒºåŸŸä»¥å¤–çš„ä½ç½®ã€‚

scrollToItem(params: object)
è¿™ä¸ªæ–¹æ³•ä¼šé¡ºåºéå†å…ƒç´ ã€‚å°½å¯èƒ½ä½¿ç”¨ scrollToIndex ã€‚ å¦‚æœä¸è®¾ç½®getItemLayoutå±æ€§çš„è¯ï¼Œå¯èƒ½ä¼šæ¯”è¾ƒå¡ã€‚

scrollToOffset(params: object)
æ»šåŠ¨åˆ—è¡¨åˆ°æŒ‡å®šçš„åç§»ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰ï¼Œç­‰åŒäº ScrollView çš„ scrollTo æ–¹æ³•ã€‚

recordInteraction()
ä¸»åŠ¨é€šçŸ¥åˆ—è¡¨å‘ç”Ÿäº†ä¸€ä¸ªäº‹ä»¶ï¼Œä»¥ä½¿åˆ—è¡¨é‡æ–°è®¡ç®—å¯è§†åŒºåŸŸã€‚æ¯”å¦‚è¯´å½“waitForInteractions ä¸º true å¹¶ä¸”ç”¨æˆ·æ²¡æœ‰æ»šåŠ¨åˆ—è¡¨æ—¶ï¼Œå°±å¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚ä¸è¿‡ä¸€èˆ¬æ¥è¯´ï¼Œå½“ç”¨æˆ·ç‚¹å‡»äº†ä¸€ä¸ªåˆ—è¡¨é¡¹ï¼Œæˆ–å‘ç”Ÿäº†ä¸€ä¸ªå¯¼èˆªåŠ¨ä½œæ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚

flashScrollIndicators()
çŸ­æš‚åœ°æ˜¾ç¤ºæ»šåŠ¨æŒ‡ç¤ºå™¨ã€‚

'use strict';

const React = require('react');
const ReactNative = require('react-native');
const {
  Animated,
  FlatList,
  StyleSheet,
  View,
} = ReactNative;

const RNTesterPage = require('./RNTesterPage');

const infoLog = require('infoLog');

const {
  FooterComponent,
  HeaderComponent,
  ItemComponent,
  PlainInput,
  SeparatorComponent,
  Spindicator,
  genItemData,
  getItemLayout,
  pressItem,
  renderSmallSwitchOption,
} = require('./ListExampleShared');

const AnimatedFlatList = Animated.createAnimatedComponent(FlatList);

const VIEWABILITY_CONFIG = {
  minimumViewTime: 3000,
  viewAreaCoveragePercentThreshold: 100,
  waitForInteraction: true,
};

class FlatListExample extends React.PureComponent {
  static title = '<FlatList>';
  static description = 'Performant, scrollable list of data.';

  state = {
    data: genItemData(100),
    debug: false,
    horizontal: false,
    filterText: '',
    fixedHeight: true,
    logViewable: false,
    virtualized: true,
  };

  _onChangeFilterText = (filterText) => {
    this.setState({filterText});
  };

  _onChangeScrollToIndex = (text) => {
    this._listRef.getNode().scrollToIndex({viewPosition: 0.5, index: Number(text)});
  };

  _scrollPos = new Animated.Value(0);
  _scrollSinkX = Animated.event(
    [{nativeEvent: { contentOffset: { x: this._scrollPos } }}],
    {useNativeDriver: true},
  );
  _scrollSinkY = Animated.event(
    [{nativeEvent: { contentOffset: { y: this._scrollPos } }}],
    {useNativeDriver: true},
  );

  componentDidUpdate() {
    this._listRef.getNode().recordInteraction(); // e.g. flipping logViewable switch
  }

  render() {
    const filterRegex = new RegExp(String(this.state.filterText), 'i');
    const filter = (item) => (
      filterRegex.test(item.text) || filterRegex.test(item.title)
    );
    const filteredData = this.state.data.filter(filter);
    return (
      <RNTesterPage
        noSpacer={true}
        noScroll={true}>
        <View style={styles.searchRow}>
          <View style={styles.options}>
            <PlainInput
              onChangeText={this._onChangeFilterText}
              placeholder="Search..."
              value={this.state.filterText}
            />
            <PlainInput
              onChangeText={this._onChangeScrollToIndex}
              placeholder="scrollToIndex..."
            />
          </View>
          <View style={styles.options}>
            {renderSmallSwitchOption(this, 'virtualized')}
            {renderSmallSwitchOption(this, 'horizontal')}
            {renderSmallSwitchOption(this, 'fixedHeight')}
            {renderSmallSwitchOption(this, 'logViewable')}
            {renderSmallSwitchOption(this, 'debug')}
            <Spindicator value={this._scrollPos} />
          </View>
        </View>
        <SeparatorComponent />
        <AnimatedFlatList
          ItemSeparatorComponent={SeparatorComponent}
          ListHeaderComponent={HeaderComponent}
          ListFooterComponent={FooterComponent}
          data={filteredData}
          debug={this.state.debug}
          disableVirtualization={!this.state.virtualized}
          getItemLayout={this.state.fixedHeight ?
            this._getItemLayout :
            undefined
          }
          horizontal={this.state.horizontal}
          key={(this.state.horizontal ? 'h' : 'v') +
            (this.state.fixedHeight ? 'f' : 'd')
          }
          legacyImplementation={false}
          numColumns={1}
          onEndReached={this._onEndReached}
          onRefresh={this._onRefresh}
          onScroll={this.state.horizontal ? this._scrollSinkX : this._scrollSinkY}
          onViewableItemsChanged={this._onViewableItemsChanged}
          ref={this._captureRef}
          refreshing={false}
          renderItem={this._renderItemComponent}
          viewabilityConfig={VIEWABILITY_CONFIG}
        />
      </RNTesterPage>
    );
  }
  _captureRef = (ref) => { this._listRef = ref; };
  _getItemLayout = (data: any, index: number) => {
    return getItemLayout(data, index, this.state.horizontal);
  };
  _onEndReached = () => {
    this.setState((state) => ({
      data: state.data.concat(genItemData(100, state.data.length)),
    }));
  };
  _onRefresh = () => alert('onRefresh: nothing to refresh :P');
  _renderItemComponent = ({item}) => {
    return (
      <ItemComponent
        item={item}
        horizontal={this.state.horizontal}
        fixedHeight={this.state.fixedHeight}
        onPress={this._pressItem}
      />
    );
  };
  // This is called when items change viewability by scrolling into or out of
  // the viewable area.
  _onViewableItemsChanged = (info: {
      changed: Array<{
        key: string,
        isViewable: boolean,
        item: any,
        index: ?number,
        section?: any,
      }>
    }
  ) => {
    // Impressions can be logged here
    if (this.state.logViewable) {
      infoLog(
        'onViewableItemsChanged: ',
        info.changed.map((v) => ({...v, item: '...'})),
      );
    }
  };
  _pressItem = (key: number) => {
    this._listRef.getNode().recordInteraction();
    pressItem(this, key);
  };
  _listRef: FlatList<*>;
}


const styles = StyleSheet.create({
  options: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    alignItems: 'center',
  },
  searchRow: {
    paddingHorizontal: 10,
  },
});

module.exports = FlatListExample;

Image
ä¸€ä¸ªç”¨äºæ˜¾ç¤ºå¤šç§ä¸åŒç±»å‹å›¾ç‰‡çš„Reactç»„ä»¶ï¼ŒåŒ…æ‹¬ç½‘ç»œå›¾ç‰‡ã€é™æ€èµ„æºã€ä¸´æ—¶çš„æœ¬åœ°å›¾ç‰‡ã€ä»¥åŠæœ¬åœ°ç£ç›˜ä¸Šçš„å›¾ç‰‡ï¼ˆå¦‚ç›¸å†Œï¼‰ç­‰ã€‚è¯¦ç»†ç”¨æ³•å‚é˜…å›¾ç‰‡æ–‡æ¡£ã€‚

ç”¨æ³•æ ·ä¾‹ï¼š

renderImages() {
  return (
    <View>
      <Image
        style={styles.icon}
        source={require('./icon.png')}
      />
      <Image
        style={styles.logo}
        source={{uri: 'http://facebook.github.io/react/img/logo_og.png'}}
      />
    </View>
  );
}
æˆªå›¾


åœ¨Androidä¸Šæ”¯æŒGIFå’ŒWebPæ ¼å¼å›¾ç‰‡
é»˜è®¤æƒ…å†µä¸‹Androidæ˜¯ä¸æ”¯æŒGIFå’ŒWebPæ ¼å¼çš„ã€‚ä½ éœ€è¦åœ¨android/app/build.gradleæ–‡ä»¶ä¸­æ ¹æ®éœ€è¦æ‰‹åŠ¨æ·»åŠ ä»¥ä¸‹æ¨¡å—ï¼š

dependencies {
  // å¦‚æœä½ éœ€è¦æ”¯æŒAndroid4.0(API level 14)ä¹‹å‰çš„ç‰ˆæœ¬
  compile 'com.facebook.fresco:animated-base-support:1.3.0'

  // å¦‚æœä½ éœ€è¦æ”¯æŒGIFåŠ¨å›¾
  compile 'com.facebook.fresco:animated-gif:1.3.0'

  // å¦‚æœä½ éœ€è¦æ”¯æŒWebPæ ¼å¼ï¼ŒåŒ…æ‹¬WebPåŠ¨å›¾
  compile 'com.facebook.fresco:animated-webp:1.3.0'
  compile 'com.facebook.fresco:webpsupport:1.3.0'

  // å¦‚æœåªéœ€è¦æ”¯æŒWebPæ ¼å¼è€Œä¸éœ€è¦åŠ¨å›¾
  compile 'com.facebook.fresco:webpsupport:1.3.0'
}
å¦‚æœä½ åœ¨ä½¿ç”¨GIFçš„åŒæ—¶è¿˜ä½¿ç”¨äº†ProGuardï¼Œé‚£ä¹ˆéœ€è¦åœ¨proguard-rules.proä¸­æ·»åŠ å¦‚ä¸‹è§„åˆ™ :

-keep class com.facebook.imagepipeline.animated.factory.AnimatedFactoryImpl {
  public AnimatedFactoryImpl(com.facebook.imagepipeline.bitmaps.PlatformBitmapFactory, com.facebook.imagepipeline.core.ExecutorSupplier);
}
å±æ€§
onLayout function
å½“å…ƒç´ æŒ‚è½½æˆ–è€…å¸ƒå±€æ”¹å˜çš„æ—¶å€™è°ƒç”¨ï¼Œå‚æ•°ä¸ºï¼š{nativeEvent: {layout: {x, y, width, height}}}.

onLoad function
åŠ è½½æˆåŠŸå®Œæˆæ—¶è°ƒç”¨æ­¤å›è°ƒå‡½æ•°ã€‚

onLoadEnd function
åŠ è½½ç»“æŸåï¼Œä¸è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œè°ƒç”¨æ­¤å›è°ƒå‡½æ•°ã€‚

onLoadStart function
åŠ è½½å¼€å§‹æ—¶è°ƒç”¨ã€‚

resizeMode enum('cover', 'contain', 'stretch', 'repeat', 'center')
å†³å®šå½“ç»„ä»¶å°ºå¯¸å’Œå›¾ç‰‡å°ºå¯¸ä¸æˆæ¯”ä¾‹çš„æ—¶å€™å¦‚ä½•è°ƒæ•´å›¾ç‰‡çš„å¤§å°ã€‚

cover: åœ¨ä¿æŒå›¾ç‰‡å®½é«˜æ¯”çš„å‰æä¸‹ç¼©æ”¾å›¾ç‰‡ï¼Œç›´åˆ°å®½åº¦å’Œé«˜åº¦éƒ½å¤§äºç­‰äºå®¹å™¨è§†å›¾çš„å°ºå¯¸ï¼ˆå¦‚æœå®¹å™¨æœ‰paddingå†…è¡¬çš„è¯ï¼Œåˆ™ç›¸åº”å‡å»ï¼‰ã€‚è¯‘æ³¨ï¼šè¿™æ ·å›¾ç‰‡å®Œå…¨è¦†ç›–ç”šè‡³è¶…å‡ºå®¹å™¨ï¼Œå®¹å™¨ä¸­ä¸ç•™ä»»ä½•ç©ºç™½ã€‚

contain: åœ¨ä¿æŒå›¾ç‰‡å®½é«˜æ¯”çš„å‰æä¸‹ç¼©æ”¾å›¾ç‰‡ï¼Œç›´åˆ°å®½åº¦å’Œé«˜åº¦éƒ½å°äºç­‰äºå®¹å™¨è§†å›¾çš„å°ºå¯¸ï¼ˆå¦‚æœå®¹å™¨æœ‰paddingå†…è¡¬çš„è¯ï¼Œåˆ™ç›¸åº”å‡å»ï¼‰ã€‚è¯‘æ³¨ï¼šè¿™æ ·å›¾ç‰‡å®Œå…¨è¢«åŒ…è£¹åœ¨å®¹å™¨ä¸­ï¼Œå®¹å™¨ä¸­å¯èƒ½ç•™æœ‰ç©ºç™½

stretch: æ‹‰ä¼¸å›¾ç‰‡ä¸”ä¸ç»´æŒå®½é«˜æ¯”ï¼Œç›´åˆ°å®½é«˜éƒ½åˆšå¥½å¡«æ»¡å®¹å™¨ã€‚

repeat: é‡å¤å¹³é“ºå›¾ç‰‡ç›´åˆ°å¡«æ»¡å®¹å™¨ã€‚å›¾ç‰‡ä¼šç»´æŒåŸå§‹å°ºå¯¸ã€‚ä»…iOSå¯ç”¨ã€‚

center: å±…ä¸­ä¸æ‹‰ä¼¸ã€‚

source {uri: string}, number
uriæ˜¯ä¸€ä¸ªè¡¨ç¤ºå›¾ç‰‡çš„èµ„æºæ ‡è¯†çš„å­—ç¬¦ä¸²ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªhttpåœ°å€æˆ–æ˜¯ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶è·¯å¾„ï¼ˆä½¿ç”¨require(ç›¸å¯¹è·¯å¾„)æ¥å¼•ç”¨ï¼‰ã€‚

This prop can also contain several remote URLs, specified together with their width and height and potentially with scale/other URI arguments. The native side will then choose the best uri to display based on the measured size of the image container. A cache property can be added to control how networked request interacts with the local cache.

ç›®å‰åŸç”Ÿæ”¯æŒçš„å›¾ç‰‡æ ¼å¼æœ‰pngã€jpgã€jpegã€bmpã€gifã€webp ï¼ˆé™Androidï¼‰ã€psd ï¼ˆé™iOSï¼‰ã€‚å½“ç„¶ä½ å¯ä»¥åœ¨githubä¸Šæ‰¾ä¸€äº›ç¬¬ä¸‰æ–¹ç»„ä»¶æ¥æ‰©å……æ”¯æŒçš„æ ¼å¼ã€‚

style style
å¸ƒå±€Flexbox...
é˜´å½±Shadow...
åŠ¨ç”»å˜æ¢Transforms...
backfaceVisibility ReactPropTypes.oneOf(['visible', 'hidden'])
resizeMode Object.keys(ImageResizeMode)
backgroundColor color
borderBottomLeftRadius ReactPropTypes.number
borderBottomRightRadius ReactPropTypes.number
borderColor color
borderRadius number
borderTopLeftRadius ReactPropTypes.number
borderTopRightRadius ReactPropTypes.number
borderWidth number
overflow enum('visible', 'hidden')
tintColor color
ä¸ºæ‰€æœ‰éé€æ˜çš„åƒç´ æŒ‡å®šä¸€ä¸ªé¢œè‰²

opacity number
overlayColor ReactPropTypes.string
å½“å›¾ç‰‡æœ‰åœ†è§’çš„æ—¶å€™ï¼ŒæŒ‡å®šä¸€ä¸ªé¢œè‰²ç”¨äºå¡«å……åœ†è§’å¤„çš„ç©ºç™½ã€‚è™½ç„¶ä¸€èˆ¬æƒ…å†µä¸‹åœ†è§’å¤„æ˜¯é€æ˜çš„ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒAndroidå¹¶ä¸æ”¯æŒåœ†è§’é€æ˜ï¼Œæ¯”å¦‚ï¼š

æŸäº›resizeæ¨¡å¼æ¯”å¦‚'contain'
GIFåŠ¨ç”»
å¸¸è§çš„ç”¨æ³•å°±æ˜¯åœ¨ä¸èƒ½åœ†è§’é€æ˜æ—¶ï¼Œè®¾ç½®overlayColorå’ŒèƒŒæ™¯è‰²ä¸€è‡´ã€‚

è¯¦ç»†è¯´æ˜å¯å‚è€ƒ http://frescolib.org/docs/rounded-corners-and-circles.html

testID string
ä¸€ä¸ªå”¯ä¸€çš„èµ„æºæ ‡è¯†ç¬¦ï¼Œç”¨æ¥åœ¨è‡ªåŠ¨æµ‹è¯•è„šæœ¬ä¸­æ ‡è¯†è¿™ä¸ªå…ƒç´ ã€‚

resizeMethod  enum('auto', 'resize', 'scale')
å½“å›¾ç‰‡å®é™…å°ºå¯¸å’Œå®¹å™¨æ ·å¼å°ºå¯¸ä¸ä¸€è‡´æ—¶ï¼Œå†³å®šä»¥æ€æ ·çš„ç­–ç•¥æ¥è°ƒæ•´å›¾ç‰‡çš„å°ºå¯¸ã€‚é»˜è®¤å€¼ä¸ºautoã€‚

autoï¼šä½¿ç”¨å¯å‘å¼ç®—æ³•æ¥åœ¨resizeå’Œscaleä¸­è‡ªåŠ¨å†³å®šã€‚

resizeï¼š åœ¨å›¾ç‰‡è§£ç ä¹‹å‰ï¼Œä½¿ç”¨è½¯ä»¶ç®—æ³•å¯¹å…¶åœ¨å†…å­˜ä¸­çš„æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚å½“å›¾ç‰‡å°ºå¯¸æ¯”å®¹å™¨å°ºå¯¸å¤§å¾—å¤šæ—¶ï¼Œåº”è¯¥ä¼˜å…ˆä½¿ç”¨æ­¤é€‰é¡¹ã€‚

scaleï¼šå¯¹å›¾ç‰‡è¿›è¡Œç¼©æ”¾ã€‚å’Œresizeç›¸æ¯”ï¼Œ scaleé€Ÿåº¦æ›´å¿«ï¼ˆä¸€èˆ¬æœ‰ç¡¬ä»¶åŠ é€Ÿï¼‰ï¼Œè€Œä¸”å›¾ç‰‡è´¨é‡æ›´ä¼˜ã€‚åœ¨å›¾ç‰‡å°ºå¯¸æ¯”å®¹å™¨å°ºå¯¸å°æˆ–è€…åªæ˜¯ç¨å¤§ä¸€ç‚¹æ—¶ï¼Œåº”è¯¥ä¼˜å…ˆä½¿ç”¨æ­¤é€‰é¡¹ã€‚

å…³äºresizeå’Œscaleçš„è¯¦ç»†è¯´æ˜è¯·å‚è€ƒhttp://frescolib.org/docs/resizing-rotating.html.

accessibilityLabel string
å½“ç”¨æˆ·ä¸å›¾ç‰‡äº¤äº’æ—¶ï¼Œè¯»å±å™¨ï¼ˆæ— éšœç¢åŠŸèƒ½ï¼‰ä¼šæœ—è¯»çš„æ–‡å­—ã€‚

accessible bool
å½“æ­¤å±æ€§ä¸ºçœŸçš„æ—¶å€™ï¼Œè¡¨ç¤ºè¿™ä¸ªå›¾ç‰‡æ˜¯ä¸€ä¸ªå¯ç”¨äº†æ— éšœç¢åŠŸèƒ½çš„å…ƒç´ ã€‚

blurRadius number
blurRadius(æ¨¡ç³ŠåŠå¾„)ï¼šä¸ºå›¾ç‰‡æ·»åŠ ä¸€ä¸ªæŒ‡å®šåŠå¾„çš„æ¨¡ç³Šæ»¤é•œã€‚

capInsets {top: number, left: number, bottom: number, right: number}
å½“å›¾ç‰‡è¢«ç¼©æ”¾çš„æ—¶å€™ï¼ŒcapInsetsæŒ‡å®šçš„è§’ä¸Šçš„å°ºå¯¸ä¼šè¢«å›ºå®šè€Œä¸è¿›è¡Œç¼©æ”¾ï¼Œè€Œä¸­é—´å’Œè¾¹ä¸Šå…¶ä»–çš„éƒ¨åˆ†åˆ™ä¼šè¢«æ‹‰ä¼¸ã€‚è¿™åœ¨åˆ¶ä½œä¸€äº›å¯å˜å¤§å°çš„åœ†è§’æŒ‰é’®ã€é˜´å½±ã€ä»¥åŠå…¶å®ƒèµ„æºçš„æ—¶å€™éå¸¸æœ‰ç”¨ï¼ˆè¯‘æ³¨ï¼šè¿™å°±æ˜¯å¸¸è¯´çš„ä¹å®«æ ¼æˆ–è€….9å›¾ã€‚äº†è§£æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥å‚è§è‹¹æœå®˜æ–¹æ–‡æ¡£

defaultSource  {uri: string, width: number, height: number, scale: number}, number
åœ¨è¯»å–å›¾ç‰‡æ—¶é»˜è®¤æ˜¾ç¤ºçš„åŠ è½½æç¤ºå›¾ç‰‡

uri - æ˜¯ä¸€ä¸ªè¡¨ç¤ºå›¾ç‰‡çš„èµ„æºæ ‡è¯†çš„å­—ç¬¦ä¸²ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªhttpåœ°å€æˆ–æ˜¯ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶è·¯å¾„ï¼ˆä½¿ç”¨require(ç›¸å¯¹è·¯å¾„)æ¥å¼•ç”¨ï¼‰ã€‚
width, height - å¦‚æœä½ çŸ¥é“å›¾ç‰‡çš„å°ºå¯¸ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨è¿™é‡ŒæŒ‡å®šã€‚è¿™ä¸€å°ºå¯¸ä¼šè¢«ç”¨ä½œ<Image/>ç»„ä»¶çš„é»˜è®¤å°ºå¯¸ã€‚
scale - å›¾ç‰‡çš„ç¼©æ”¾ç³»æ•°ã€‚é»˜è®¤æ˜¯1.0ï¼Œæ„å‘³ç€æ¯ä¸€ä¸ªå›¾ç‰‡åƒç´ éƒ½å¯¹åº”ä¸€ä¸ªè®¾å¤‡ç‹¬ç«‹åƒç´ ï¼ˆDIPï¼‰ã€‚
number - æœ¬åœ°å›¾ç‰‡å¼•ç”¨è¯­æ³•require('./image.jpg')æ‰€è¿”å›çš„å†…éƒ¨èµ„æºidã€‚
onError function
å½“åŠ è½½é”™è¯¯çš„æ—¶å€™è°ƒç”¨æ­¤å›è°ƒå‡½æ•°ï¼Œå‚æ•°ä¸º{nativeEvent: {error}}

onPartialLoad  function
å¦‚æœå›¾ç‰‡æœ¬èº«æ”¯æŒé€æ­¥åŠ è½½ï¼Œåˆ™é€æ­¥åŠ è½½çš„è¿‡ç¨‹ä¸­ä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚â€œé€æ­¥åŠ è½½â€çš„å…·ä½“å®šä¹‰ä¸å…·ä½“çš„æ ‡å‡†å’Œå®ç°æœ‰å…³ã€‚

onProgress function
åœ¨åŠ è½½è¿‡ç¨‹ä¸­ä¸æ–­è°ƒç”¨ï¼Œå‚æ•°ä¸º{nativeEvent: {loaded, total}}

æ–¹æ³•
static getSize(uri: string, success: (width: number, height: number) => void, failure: (error: any) => void)
åœ¨æ˜¾ç¤ºå›¾ç‰‡å‰è·å–å›¾ç‰‡çš„å®½é«˜(ä»¥åƒç´ ä¸ºå•ä½)ã€‚å¦‚æœå›¾ç‰‡åœ°å€ä¸æ­£ç¡®æˆ–ä¸‹è½½å¤±è´¥,æ­¤æ–¹æ³•ä¹Ÿä¼šå¤±è´¥ã€‚

è¦è·å–å›¾ç‰‡çš„å°ºå¯¸,é¦–å…ˆéœ€è¦åŠ è½½æˆ–ä¸‹è½½å›¾ç‰‡(åŒæ—¶ä¼šè¢«ç¼“å­˜èµ·æ¥)ã€‚è¿™æ„å‘³ç€ç†è®ºä¸Šä½ å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥é¢„åŠ è½½å›¾ç‰‡ï¼Œè™½ç„¶æ­¤æ–¹æ³•å¹¶æ²¡æœ‰é’ˆå¯¹è¿™ä¸€ç”¨æ³•è¿›è¡Œä¼˜åŒ–ï¼Œè€Œä¸”å°†æ¥å¯èƒ½ä¼šæ¢ä¸€äº›å®ç°æ–¹æ¡ˆä½¿å¾—å¹¶ä¸éœ€è¦å®Œæ•´ä¸‹è½½å›¾ç‰‡å³å¯è·å–å°ºå¯¸ã€‚æ‰€ä»¥æ›´å¥½çš„é¢„åŠ è½½æ–¹æ¡ˆæ˜¯ä½¿ç”¨ä¸‹é¢é‚£ä¸ªä¸“é—¨çš„é¢„åŠ è½½æ–¹æ³•ã€‚

static prefetch(url: string)
é¢„åŠ è½½ä¸€ä¸ªè¿œç¨‹å›¾ç‰‡(å°†å…¶ä¸‹è½½åˆ°æœ¬åœ°ç£ç›˜ç¼“å­˜)ã€‚

ä¾‹å­
'use strict';

var React = require('react');
var ReactNative = require('react-native');
var {
  ActivityIndicator,
  Image,
  Platform,
  StyleSheet,
  Text,
  View,
} = ReactNative;

var base64Icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAABLCAQAAACSR7JhAAADtUlEQVR4Ac3YA2Bj6QLH0XPT1Fzbtm29tW3btm3bfLZtv7e2ObZnms7d8Uw098tuetPzrxv8wiISrtVudrG2JXQZ4VOv+qUfmqCGGl1mqLhoA52oZlb0mrjsnhKpgeUNEs91Z0pd1kvihA3ULGVHiQO2narKSHKkEMulm9VgUyE60s1aWoMQUbpZOWE+kaqs4eLEjdIlZTcFZB0ndc1+lhB1lZrIuk5P2aib1NBpZaL+JaOGIt0ls47SKzLC7CqrlGF6RZ09HGoNy1lYl2aRSWL5GuzqWU1KafRdoRp0iOQEiDzgZPnG6DbldcomadViflnl/cL93tOoVbsOLVM2jylvdWjXolWX1hmfZbGR/wjypDjFLSZIRov09BgYmtUqPQPlQrPapecLgTIy0jMgPKtTeob2zWtrGH3xvjUkPCtNg/tm1rjwrMa+mdUkPd3hWbH0jArPGiU9ufCsNNWFZ40wpwn+62/66R2RUtoso1OB34tnLOcy7YB1fUdc9e0q3yru8PGM773vXsuZ5YIZX+5xmHwHGVvlrGPN6ZSiP1smOsMMde40wKv2VmwPPVXNut4sVpUreZiLBHi0qln/VQeI/LTMYXpsJtFiclUN+5HVZazim+Ky+7sAvxWnvjXrJFneVtLWLyPJu9K3cXLWeOlbMTlrIelbMDlrLenrjEQOtIF+fuI9xRp9ZBFp6+b6WT8RrxEpdK64BuvHgDk+vUy+b5hYk6zfyfs051gRoNO1usU12WWRWL73/MMEy9pMi9qIrR4ZpV16Rrvduxazmy1FSvuFXRkqTnE7m2kdb5U8xGjLw/spRr1uTov4uOgQE+0N/DvFrG/Jt7i/FzwxbA9kDanhf2w+t4V97G8lrT7wc08aA2QNUkuTfW/KimT01wdlfK4yEw030VfT0RtZbzjeMprNq8m8tnSTASrTLti64oBNdpmMQm0eEwvfPwRbUBywG5TzjPCsdwk3IeAXjQblLCoXnDVeoAz6SfJNk5TTzytCNZk/POtTSV40NwOFWzw86wNJRpubpXsn60NJFlHeqlYRbslqZm2jnEZ3qcSKgm0kTli3zZVS7y/iivZTweYXJ26Y+RTbV1zh3hYkgyFGSTKPfRVbRqWWVReaxYeSLarYv1Qqsmh1s95S7G+eEWK0f3jYKTbV6bOwepjfhtafsvUsqrQvrGC8YhmnO9cSCk3yuY984F1vesdHYhWJ5FvASlacshUsajFt2mUM9pqzvKGcyNJW0arTKN1GGGzQlH0tXwLDgQTurS8eIQAAAABJRU5ErkJggg==';

var ImageCapInsetsExample = require('./ImageCapInsetsExample');
const IMAGE_PREFETCH_URL = 'http://origami.design/public/images/bird-logo.png?r=1&t=' + Date.now();
var prefetchTask = Image.prefetch(IMAGE_PREFETCH_URL);

var NetworkImageCallbackExample = React.createClass({
  getInitialState: function() {
    return {
      events: [],
      startLoadPrefetched: false,
      mountTime: new Date(),
    };
  },

  componentWillMount() {
    this.setState({mountTime: new Date()});
  },

  render: function() {
    var { mountTime } = this.state;

    return (
      <View>
        <Image
          source={this.props.source}
          style={[styles.base, {overflow: 'visible'}]}
          onLoadStart={() => this._loadEventFired(`âœ” onLoadStart (+${new Date() - mountTime}ms)`)}
          onLoad={(event) => {
            // Currently this image source feature is only available on iOS.
            if (event.nativeEvent.source) {
              const url = event.nativeEvent.source.url;
              this._loadEventFired(`âœ” onLoad (+${new Date() - mountTime}ms) for URL ${url}`);
            } else {
              this._loadEventFired(`âœ” onLoad (+${new Date() - mountTime}ms)`);
            }
          }}
          onLoadEnd={() => {
            this._loadEventFired(`âœ” onLoadEnd (+${new Date() - mountTime}ms)`);
            this.setState({startLoadPrefetched: true}, () => {
              prefetchTask.then(() => {
                this._loadEventFired(`âœ” Prefetch OK (+${new Date() - mountTime}ms)`);
              }, error => {
                this._loadEventFired(`âœ˜ Prefetch failed (+${new Date() - mountTime}ms)`);
              });
            });
          }}
        />
        {this.state.startLoadPrefetched ?
          <Image
            source={this.props.prefetchedSource}
            style={[styles.base, {overflow: 'visible'}]}
            onLoadStart={() => this._loadEventFired(`âœ” (prefetched) onLoadStart (+${new Date() - mountTime}ms)`)}
            onLoad={(event) => {
              // Currently this image source feature is only available on iOS.
              if (event.nativeEvent.source) {
                const url = event.nativeEvent.source.url;
                this._loadEventFired(`âœ” (prefetched) onLoad (+${new Date() - mountTime}ms) for URL ${url}`);
              } else {
                this._loadEventFired(`âœ” (prefetched) onLoad (+${new Date() - mountTime}ms)`);
              }
            }}
            onLoadEnd={() => this._loadEventFired(`âœ” (prefetched) onLoadEnd (+${new Date() - mountTime}ms)`)}
          />
          : null}
        <Text style={{marginTop: 20}}>
          {this.state.events.join('\n')}
        </Text>
      </View>
    );
  },

  _loadEventFired(event) {
    this.setState((state) => {
      return state.events = [...state.events, event];
    });
  }
});

var NetworkImageExample = React.createClass({
  getInitialState: function() {
    return {
      error: false,
      loading: false,
      progress: 0
    };
  },
  render: function() {
    var loader = this.state.loading ?
      <View style={styles.progress}>
        <Text>{this.state.progress}%</Text>
        <ActivityIndicator style={{marginLeft:5}} />
      </View> : null;
    return this.state.error ?
      <Text>{this.state.error}</Text> :
      <Image
        source={this.props.source}
        style={[styles.base, {overflow: 'visible'}]}
        onLoadStart={(e) => this.setState({loading: true})}
        onError={(e) => this.setState({error: e.nativeEvent.error, loading: false})}
        onProgress={(e) => this.setState({progress: Math.round(100 * e.nativeEvent.loaded / e.nativeEvent.total)})}
        onLoad={() => this.setState({loading: false, error: false})}>
        {loader}
      </Image>;
  }
});

var ImageSizeExample = React.createClass({
  getInitialState: function() {
    return {
      width: 0,
      height: 0,
    };
  },
  componentDidMount: function() {
    Image.getSize(this.props.source.uri, (width, height) => {
      this.setState({width, height});
    });
  },
  render: function() {
    return (
      <View style={{flexDirection: 'row'}}>
        <Image
          style={{
            width: 60,
            height: 60,
            backgroundColor: 'transparent',
            marginRight: 10,
          }}
          source={this.props.source} />
        <Text>
          Actual dimensions:{'\n'}
          Width: {this.state.width}, Height: {this.state.height}
        </Text>
      </View>
    );
  },
});

var MultipleSourcesExample = React.createClass({
  getInitialState: function() {
    return {
      width: 30,
      height: 30,
    };
  },
  render: function() {
    return (
      <View>
        <View style={{flexDirection: 'row', justifyContent: 'space-between'}}>
          <Text
            style={styles.touchableText}
            onPress={this.decreaseImageSize} >
            Decrease image size
          </Text>
          <Text
            style={styles.touchableText}
            onPress={this.increaseImageSize} >
            Increase image size
          </Text>
        </View>
        <Text>Container image size: {this.state.width}x{this.state.height} </Text>
        <View
          style={{height: this.state.height, width: this.state.width}} >
          <Image
            style={{flex: 1}}
            source={[
              {uri: 'https://facebook.github.io/react/img/logo_small.png', width: 38, height: 38},
              {uri: 'https://facebook.github.io/react/img/logo_small_2x.png', width: 76, height: 76},
              {uri: 'https://facebook.github.io/react/img/logo_og.png', width: 400, height: 400}
            ]}
          />
        </View>
      </View>
    );
  },
  increaseImageSize: function() {
    if (this.state.width >= 100) {
      return;
    }
    this.setState({
      width: this.state.width + 10,
      height: this.state.height + 10,
    });
  },
  decreaseImageSize: function() {
    if (this.state.width <= 10) {
      return;
    }
    this.setState({
      width: this.state.width - 10,
      height: this.state.height - 10,
    });
  },
});

exports.displayName = (undefined: ?string);
exports.framework = 'React';
exports.title = '<Image>';
exports.description = 'Base component for displaying different types of images.';

exports.examples = [
  {
    title: 'Plain Network Image',
    description: 'If the `source` prop `uri` property is prefixed with ' +
    '"http", then it will be downloaded from the network.',
    render: function() {
      return (
        <Image
          source={{uri: 'https://facebook.github.io/react/img/logo_og.png'}}
          style={styles.base}
        />
      );
    },
  },
  {
    title: 'Plain Static Image',
    description: 'Static assets should be placed in the source code tree, and ' +
    'required in the same way as JavaScript modules.',
    render: function() {
      return (
        <View style={styles.horizontal}>
          <Image source={require('./uie_thumb_normal.png')} style={styles.icon} />
          <Image source={require('./uie_thumb_selected.png')} style={styles.icon} />
          <Image source={require('./uie_comment_normal.png')} style={styles.icon} />
          <Image source={require('./uie_comment_highlighted.png')} style={styles.icon} />
        </View>
      );
    },
  },
  {
    title: 'Image Loading Events',
    render: function() {
      return (
        <NetworkImageCallbackExample source={{uri: 'http://origami.design/public/images/bird-logo.png?r=1&t=' + Date.now()}}
          prefetchedSource={{uri: IMAGE_PREFETCH_URL}}/>
      );
    },
  },
  {
    title: 'Error Handler',
    render: function() {
      return (
        <NetworkImageExample source={{uri: 'https://TYPO_ERROR_facebook.github.io/react/img/logo_og.png'}} />
      );
    },
    platform: 'ios',
  },
  {
    title: 'Image Download Progress',
    render: function() {
      return (
        <NetworkImageExample source={{uri: 'http://origami.design/public/images/bird-logo.png?r=1'}}/>
      );
    },
    platform: 'ios',
  },
  {
    title: 'defaultSource',
    description: 'Show a placeholder image when a network image is loading',
    render: function() {
      return (
        <Image
          defaultSource={require('./bunny.png')}
          source={{uri: 'https://facebook.github.io/origami/public/images/birds.jpg'}}
          style={styles.base}
        />
      );
    },
    platform: 'ios',
  },
  {
    title: 'Border Color',
    render: function() {
      return (
        <View style={styles.horizontal}>
          <Image
            source={smallImage}
            style={[
              styles.base,
              styles.background,
              {borderWidth: 3, borderColor: '#f099f0'}
            ]}
          />
        </View>
      );
    },
  },
  {
    title: 'Border Width',
    render: function() {
      return (
        <View style={styles.horizontal}>
          <Image
            source={smallImage}
            style={[
              styles.base,
              styles.background,
              {borderWidth: 5, borderColor: '#f099f0'}
            ]}
          />
        </View>
      );
    },
  },
  {
    title: 'Border Radius',
    render: function() {
      return (
        <View style={styles.horizontal}>
          <Image
            style={[styles.base, {borderRadius: 5}]}
            source={fullImage}
          />
          <Image
            style={[styles.base, styles.leftMargin, {borderRadius: 19}]}
            source={fullImage}
          />
        </View>
      );
    },
  },
  {
    title: 'Background Color',
    render: function() {
      return (
        <View style={styles.horizontal}>
          <Image source={smallImage} style={styles.base} />
          <Image
            style={[
              styles.base,
              styles.leftMargin,
              {backgroundColor: 'rgba(0, 0, 100, 0.25)'}
            ]}
            source={smallImage}
          />
          <Image
            style={[styles.base, styles.leftMargin, {backgroundColor: 'red'}]}
            source={smallImage}
          />
          <Image
            style={[styles.base, styles.leftMargin, {backgroundColor: 'black'}]}
            source={smallImage}
          />
        </View>
      );
    },
  },
  {
    title: 'Opacity',
    render: function() {
      return (
        <View style={styles.horizontal}>
          <Image
            style={[styles.base, {opacity: 1}]}
            source={fullImage}
          />
          <Image
            style={[styles.base, styles.leftMargin, {opacity: 0.8}]}
            source={fullImage}
          />
          <Image
            style={[styles.base, styles.leftMargin, {opacity: 0.6}]}
            source={fullImage}
          />
          <Image
            style={[styles.base, styles.leftMargin, {opacity: 0.4}]}
            source={fullImage}
          />
          <Image
            style={[styles.base, styles.leftMargin, {opacity: 0.2}]}
            source={fullImage}
          />
          <Image
            style={[styles.base, styles.leftMargin, {opacity: 0}]}
            source={fullImage}
          />
        </View>
      );
    },
  },
  {
    title: 'Nesting',
    render: function() {
      return (
        <Image
          style={{width: 60, height: 60, backgroundColor: 'transparent'}}
          source={fullImage}>
          <Text style={styles.nestedText}>
            React
          </Text>
        </Image>
      );
    },
  },
  {
    title: 'Tint Color',
    description: 'The `tintColor` style prop changes all the non-alpha ' +
      'pixels to the tint color.',
    render: function() {
      return (
        <View>
          <View style={styles.horizontal}>
            <Image
              source={require('./uie_thumb_normal.png')}
              style={[styles.icon, {borderRadius: 5, tintColor: '#5ac8fa' }]}
            />
            <Image
              source={require('./uie_thumb_normal.png')}
              style={[styles.icon, styles.leftMargin, {borderRadius: 5, tintColor: '#4cd964' }]}
            />
            <Image
              source={require('./uie_thumb_normal.png')}
              style={[styles.icon, styles.leftMargin, {borderRadius: 5, tintColor: '#ff2d55' }]}
            />
            <Image
              source={require('./uie_thumb_normal.png')}
              style={[styles.icon, styles.leftMargin, {borderRadius: 5, tintColor: '#8e8e93' }]}
            />
          </View>
          <Text style={styles.sectionText}>
            It also works with downloaded images:
          </Text>
          <View style={styles.horizontal}>
            <Image
              source={smallImage}
              style={[styles.base, {borderRadius: 5, tintColor: '#5ac8fa' }]}
            />
            <Image
              source={smallImage}
              style={[styles.base, styles.leftMargin, {borderRadius: 5, tintColor: '#4cd964' }]}
            />
            <Image
              source={smallImage}
              style={[styles.base, styles.leftMargin, {borderRadius: 5, tintColor: '#ff2d55' }]}
            />
            <Image
              source={smallImage}
              style={[styles.base, styles.leftMargin, {borderRadius: 5, tintColor: '#8e8e93' }]}
            />
          </View>
        </View>
      );
    },
  },
  {
    title: 'Resize Mode',
    description: 'The `resizeMode` style prop controls how the image is ' +
      'rendered within the frame.',
    render: function() {
      return (
        <View>
          {[smallImage, fullImage].map((image, index) => {
            return (
            <View key={index}>
              <View style={styles.horizontal}>
                <View>
                  <Text style={[styles.resizeModeText]}>
                    Contain
                  </Text>
                  <Image
                    style={styles.resizeMode}
                    resizeMode={Image.resizeMode.contain}
                    source={image}
                  />
                </View>
                <View style={styles.leftMargin}>
                  <Text style={[styles.resizeModeText]}>
                    Cover
                  </Text>
                  <Image
                    style={styles.resizeMode}
                    resizeMode={Image.resizeMode.cover}
                    source={image}
                  />
                </View>
              </View>
              <View style={styles.horizontal}>
                <View>
                  <Text style={[styles.resizeModeText]}>
                    Stretch
                  </Text>
                  <Image
                    style={styles.resizeMode}
                    resizeMode={Image.resizeMode.stretch}
                    source={image}
                  />
                </View>
                { Platform.OS === 'ios' ?
                  <View style={styles.leftMargin}>
                    <Text style={[styles.resizeModeText]}>
                      Repeat
                    </Text>
                    <Image
                      style={styles.resizeMode}
                      resizeMode={Image.resizeMode.repeat}
                      source={image}
                    />
                  </View>
                : null }
                { Platform.OS === 'android' ?
                  <View style={styles.leftMargin}>
                    <Text style={[styles.resizeModeText]}>
                      Center
                    </Text>
                    <Image
                      style={styles.resizeMode}
                      resizeMode={Image.resizeMode.center}
                      source={image}
                    />
                  </View>
                : null }
              </View>
            </View>
          );
        })}
        </View>
      );
    },
  },
  {
    title: 'Animated GIF',
    render: function() {
      return (
        <Image
          style={styles.gif}
          source={{uri: 'https://38.media.tumblr.com/9e9bd08c6e2d10561dd1fb4197df4c4e/tumblr_mfqekpMktw1rn90umo1_500.gif'}}
        />
      );
    },
    platform: 'ios',
  },
  {
    title: 'Base64 image',
    render: function() {
      return (
        <Image
          style={styles.base64}
          source={{uri: base64Icon, scale: 3}}
        />
      );
    },
    platform: 'ios',
  },
  {
    title: 'Cap Insets',
    description:
      'When the image is resized, the corners of the size specified ' +
      'by capInsets will stay a fixed size, but the center content and ' +
      'borders of the image will be stretched. This is useful for creating ' +
      'resizable rounded buttons, shadows, and other resizable assets.',
    render: function() {
      return <ImageCapInsetsExample />;
    },
    platform: 'ios',
  },
  {
    title: 'Image Size',
    render: function() {
      return <ImageSizeExample source={fullImage} />;
    },
  },
  {
    title: 'MultipleSourcesExample',
    description:
      'The `source` prop allows passing in an array of uris, so that native to choose which image ' +
      'to diplay based on the size of the of the target image',
    render: function() {
      return <MultipleSourcesExample />;
    },
  },
  {
    title: 'Legacy local image',
    description:
      'Images shipped with the native bundle, but not managed ' +
      'by the JS packager',
    render: function() {
      return (
        <Image
          source={{uri: 'legacy_image', width: 120, height: 120}}
        />
      );
    },
  },
  {
    title: 'Bundled images',
    description:
      'Images shipped in a separate native bundle',
    render: function() {
      return (
        <View style={{flexDirection: 'row'}}>
          <Image
            source={{
              url: 'ImageInBundle',
              bundle: 'RNTesterBundle',
              width: 100,
              height: 100,
            }}
            style={{borderColor: 'yellow', borderWidth: 4}}
          />
          <Image
            source={{
              url: 'ImageInAssetCatalog',
              bundle: 'RNTesterBundle',
              width: 100,
              height: 100,
            }}
            style={{marginLeft: 10, borderColor: 'blue', borderWidth: 4}}
          />
        </View>
      );
    },
    platform: 'ios',
  },
];

var fullImage = {uri: 'https://facebook.github.io/react/img/logo_og.png'};
var smallImage = {uri: 'https://facebook.github.io/react/img/logo_small_2x.png'};

var styles = StyleSheet.create({
  base: {
    width: 38,
    height: 38,
  },
  progress: {
    flex: 1,
    alignItems: 'center',
    flexDirection: 'row',
    width: 100
  },
  leftMargin: {
    marginLeft: 10,
  },
  background: {
    backgroundColor: '#222222'
  },
  sectionText: {
    marginVertical: 6,
  },
  nestedText: {
    marginLeft: 12,
    marginTop: 20,
    backgroundColor: 'transparent',
    color: 'white'
  },
  resizeMode: {
    width: 90,
    height: 60,
    borderWidth: 0.5,
    borderColor: 'black'
  },
  resizeModeText: {
    fontSize: 11,
    marginBottom: 3,
  },
  icon: {
    width: 15,
    height: 15,
  },
  horizontal: {
    flexDirection: 'row',
  },
  gif: {
    flex: 1,
    height: 200,
  },
  base64: {
    flex: 1,
    height: 50,
    resizeMode: 'contain',
  },
  touchableText: {
    fontWeight: '500',
    color: 'blue',
  },
});

KeyboardAvoidingView

æœ¬ç»„ä»¶ç”¨äºè§£å†³ä¸€ä¸ªå¸¸è§çš„å°´å°¬é—®é¢˜ï¼šæ‰‹æœºä¸Šå¼¹å‡ºçš„é”®ç›˜å¸¸å¸¸ä¼šæŒ¡ä½å½“å‰çš„è§†å›¾ã€‚æœ¬ç»„ä»¶å¯ä»¥è‡ªåŠ¨æ ¹æ®é”®ç›˜çš„ä½ç½®ï¼Œè°ƒæ•´è‡ªèº«çš„positionæˆ–åº•éƒ¨çš„paddingï¼Œä»¥é¿å…è¢«é®æŒ¡ã€‚

å±æ€§
View props...
behavior PropTypes.oneOf(['height', 'position', 'padding'])
contentContainerStyle  View#style
å¦‚æœè®¾å®šbehaviorå€¼ä¸º'position'ï¼Œåˆ™ä¼šç”Ÿæˆä¸€ä¸ªViewä½œä¸ºå†…å®¹å®¹å™¨ã€‚æ­¤å±æ€§ç”¨äºæŒ‡å®šæ­¤å†…å®¹å®¹å™¨çš„æ ·å¼ã€‚

keyboardVerticalOffset  PropTypes.number.isRequired
æœ‰æ—¶å€™åº”ç”¨ç¦»å±å¹•é¡¶éƒ¨è¿˜æœ‰ä¸€äº›è·ç¦»ï¼ˆæ¯”å¦‚çŠ¶æ€æ ç­‰ç­‰ï¼‰ï¼Œåˆ©ç”¨æ­¤å±æ€§æ¥è¡¥å¿ä¿®æ­£è¿™æ®µè·ç¦»ã€‚

æ–¹æ³•
relativeKeyboardHeight(keyboardFrame):
onKeyboardChange(event)
onLayout(event)
ä¾‹å­
'use strict';

const React = require('React');
const ReactNative = require('react-native');
const {
  KeyboardAvoidingView,
  Modal,
  SegmentedControlIOS,
  StyleSheet,
  Text,
  TextInput,
  TouchableHighlight,
  View,
} = ReactNative;

const RNTesterBlock = require('./RNTesterBlock');
const RNTesterPage = require('./RNTesterPage');

class KeyboardAvoidingViewExample extends React.Component {
  static title = '<KeyboardAvoidingView>';
  static description = 'Base component for views that automatically adjust their height or position to move out of the way of the keyboard.';

  state = {
    behavior: 'padding',
    modalOpen: false,
  };

  onSegmentChange = (segment: String) => {
    this.setState({behavior: segment.toLowerCase()});
  };

  renderExample = () => {
    return (
      <View style={styles.outerContainer}>
        <Modal animationType="fade" visible={this.state.modalOpen}>
          <KeyboardAvoidingView behavior={this.state.behavior} style={styles.container}>
            <SegmentedControlIOS
              onValueChange={this.onSegmentChange}
              selectedIndex={this.state.behavior === 'padding' ? 0 : 1}
              style={styles.segment}
              values={['Padding', 'Position']} />
            <TextInput
              placeholder="<TextInput />"
              style={styles.textInput} />
          </KeyboardAvoidingView>
          <TouchableHighlight
            onPress={() => this.setState({modalOpen: false})}
            style={styles.closeButton}>
            <Text>Close</Text>
          </TouchableHighlight>
        </Modal>

        <TouchableHighlight onPress={() => this.setState({modalOpen: true})}>
          <Text>Open Example</Text>
        </TouchableHighlight>
      </View>
    );
  };

  render() {
    return (
      <RNTesterPage title="Keyboard Avoiding View">
        <RNTesterBlock title="Keyboard-avoiding views move out of the way of the keyboard.">
          {this.renderExample()}
        </RNTesterBlock>
      </RNTesterPage>
    );
  }
}

const styles = StyleSheet.create({
  outerContainer: {
    flex: 1,
  },
  container: {
    flex: 1,
    justifyContent: 'center',
    paddingHorizontal: 20,
    paddingTop: 20,
  },
  textInput: {
    borderRadius: 5,
    borderWidth: 1,
    height: 44,
    paddingHorizontal: 10,
  },
  segment: {
    marginBottom: 10,
  },
  closeButton: {
    position: 'absolute',
    top: 30,
    left: 10,
  }
});

module.exports = KeyboardAvoidingViewExample;
